
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means &#8212; Showcase Jupyter notebooks series</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Urban Heat Island effect in Fortaleza, Brazil" href="Urban-heat-island-ERA5-Land.html" />
    <link rel="prev" title="Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog" href="CMIP6_hr_1985-2014.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/reliance-icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Showcase Jupyter notebooks series</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../welcome.html">
   Welcome to RELIANCE showcase series
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../CONDUCT.html">
   Code of Conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LICENSE.html">
   LICENSE
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ADAM service jupyter notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../adam/setup.html">
   ADAM service
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../adam/notebooks/MOD_AquaCHL_ADAM.html">
     Using ADAM-API to access MODIS Aqua CHL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../adam/notebooks/UERRA_ADAM.html">
     Using ADAM-API to access UERRA regional reanalysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ROHUB service jupyter notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../rohub/setup.html">
   ROHUB service
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../rohub/notebooks/ROHub-library-prod-demo.html">
     Example to use Rohub from Jupyter notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../rohub/notebooks/Sharing-files-EGI-DataHub.html">
     WORKING WITH EGI DATAHUB
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Scientific showcase series
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../eosc-future.html">
   EOSC-Future demo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/README.html">
     Demo for EOSC-Future
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE-Datacube-featuring-EOSC.html">
     Using CAMS European air quality analysis from Copernicus Atmosphere Monitoring with RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_France_PM10.html">
     PM10 over France with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Italy_NO2.html">
     NO2 over Italy with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway-Viken_NO2.html">
     NO2 over Viken &amp; Oslo (Norway) with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway-Viken_PM10.html">
     PM10 over Viken &amp; Oslo (Norway) with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway-Viken_PM25.html">
     PM2.5 over Viken &amp; Oslo (Norway) with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway_PM10.html">
     PM10 over Norway with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro.html">
   Notebooks from researchers
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="CMIP6_hr_1985-2014.html">
     Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Urban-heat-island-ERA5-Land.html">
     Urban Heat Island effect in Fortaleza, Brazil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="air_quality_lockdown.html">
     Impact of the Covid-19 Lockdown on Air quality over Europe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="comparisons_with_air_quality_measurements.html">
     Jupyter notebook comparing CAMS and air quality measurements
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/science/notebooks/ERA5_1985-2014.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/NordicESMHub/RELIANCE"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/NordicESMHub/RELIANCE/issues/new?title=Issue%20on%20page%20%2Fscience/notebooks/ERA5_1985-2014.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/NordicESMHub/RELIANCE/main?urlpath=tree/content/science/notebooks/ERA5_1985-2014.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-id-introduction-a">
   1. Introduction
   <a id="introduction">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">
   2. Data Wrangling
   <a id="data_wrangling">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-python-packages">
     Import python packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-era5-variables">
     Open ERA5 variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-attributes-matching-cmip6-data">
     Change attributes matching CMIP6 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-mixed-phase-clouds">
     Find mixed-phase clouds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics">
     Create dictionary from the list of datasets we want to use for the IWC/LWC statistics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a">
     Regrid ERA5 data to common NorESM2-MM grid
     <a id="regrid_hz">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-following-cell-is-not-needed">
     The following cell is not needed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connect-all-statistics-into-one-dataset-with-new-coordinate-statistic">
     Connect all statistics into one Dataset with new coordinate ‘statistic’
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-a-id-exploratory-a">
   3. Exploratory Data Analysis
   <a id="exploratory">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-seasonal-mean-spread-of-all-era5-data">
     Create seasonal mean/spread of all ERA5 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-latitude-band-mean-of-variables">
     Calculate latitude band mean of variables
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-id-introduction-a">
   1. Introduction
   <a id="introduction">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">
   2. Data Wrangling
   <a id="data_wrangling">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-python-packages">
     Import python packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-era5-variables">
     Open ERA5 variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-attributes-matching-cmip6-data">
     Change attributes matching CMIP6 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-mixed-phase-clouds">
     Find mixed-phase clouds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics">
     Create dictionary from the list of datasets we want to use for the IWC/LWC statistics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a">
     Regrid ERA5 data to common NorESM2-MM grid
     <a id="regrid_hz">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-following-cell-is-not-needed">
     The following cell is not needed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connect-all-statistics-into-one-dataset-with-new-coordinate-statistic">
     Connect all statistics into one Dataset with new coordinate ‘statistic’
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-a-id-exploratory-a">
   3. Exploratory Data Analysis
   <a id="exploratory">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-seasonal-mean-spread-of-all-era5-data">
     Create seasonal mean/spread of all ERA5 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-latitude-band-mean-of-variables">
     Calculate latitude band mean of variables
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="cloud-feedback-analysis-with-era5-high-resolution-0-25deg-monthly-means">
<h1>Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means<a class="headerlink" href="#cloud-feedback-analysis-with-era5-high-resolution-0-25deg-monthly-means" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h1>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#data_wrangling">2. Data Wrangling</a></li>
<li><a href="#exploratory">3. Exploratory Data Analysis</a></li>
<li><a href="#conclusion">4. Conclusion</a></li>
<li><a href="#references">5. References</a></li>
</ul></div>
<div class="tex2jax_ignore mathjax_ignore section" id="introduction-a-id-introduction-a">
<h1>1. Introduction <a id='introduction'></a><a class="headerlink" href="#introduction-a-id-introduction-a" title="Permalink to this headline">¶</a></h1>
<p>Cloud feedbacks are a major contributor to the spread of climate sensitivity in global climate models (GCMs) (<a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019GL085782">Zelinka et al. (2020)</a>]). Among the most poorly understood cloud feedbacks is the one associated with the cloud phase, which is expected to be modified with climate change (<a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1">Bjordal et al. (2020)</a>). Cloud phase bias, in addition, has significant implications for the simulation of radiative properties and glacier and ice sheet mass balances in climate models.</p>
<p>In this context, this work aims to expand our knowledge on how the representation of the cloud phase affects snow formation in GCMs. Better understanding this aspect is necessary to develop climate models further and improve future climate predictions.</p>
<ul class="simple">
<li><p>Load ERA5 data previously downloaded locally via <a class="reference external" href="https://github.com/franzihe/download_ERA5">Jupyter Notebook - download ERA5</a></p></li>
<li><p>find clouds: liquid-only, ice-only, mixed-phase</p></li>
<li><p>Regridd the ERA5 variables to the same horizontal resolution as high-resolution CMIP6 models with <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">xesmf</span></code></a></p></li>
<li><p>Calculate and plot the seasonal mean of the variable</p></li>
</ul>
<p><strong>Questions</strong></p>
<ul class="simple">
<li><p>How is the cloud phase and snowfall varying between 1985 and 2014?</p></li>
</ul>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> We answer questions related to the comparison of CMIP models to ERA5 in another <span class="xref myst">Jupyter Notebook</span>.</p>
</div></blockquote>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-wrangling-a-id-data-wrangling-a">
<h1>2. Data Wrangling <a id='data_wrangling'></a><a class="headerlink" href="#data-wrangling-a-id-data-wrangling-a" title="Permalink to this headline">¶</a></h1>
<p>This study will compare surface snowfall, ice, and liquid water content from the Coupled Model Intercomparison Project Phase 6 (<a class="reference external" href="https://esgf-node.llnl.gov/projects/cmip6/">CMIP6</a>) climate models (accessed through <a class="reference external" href="https://pangeo.io/">Pangeo</a>) to the European Centre for Medium-Range Weather Forecast Re-Analysis 5 (<a class="reference external" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ERA5</a>) data from <strong>1985 to 2014</strong>. We conduct statistical analysis at the annual and seasonal timescales to determine the biases in cloud phase and precipitation (liquid and solid) in the CMIP6 models and their potential connection between them. The CMIP6 data analysis can be found in the <span class="xref myst">Jupyter Notebook for CMIP6</span>.</p>
<ul class="simple">
<li><p>Time period: 1985 to 2014</p></li>
<li><p>horizonal resolution: ~0.25deg</p></li>
<li><p>time resolution: monthly atmospheric data</p></li>
<li><p>Variables:</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>shortname</p></th>
<th class="text-align:center head"><p>Long name</p></th>
<th class="text-align:right head"><p>Units</p></th>
<th class="text-align:right head"><p>levels</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sf</p></td>
<td class="text-align:center"><p>snowfall</p></td>
<td class="text-align:right"><p>[m of water eq]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-odd"><td><p>msr</p></td>
<td class="text-align:center"><p>mean_snowfall_rate</p></td>
<td class="text-align:right"><p>[kg m-2 s-1]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-even"><td><p>cswc</p></td>
<td class="text-align:center"><p>specific_snow_water_content</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-odd"><td><p>clwc</p></td>
<td class="text-align:center"><p>specific_cloud_liquid_water_content</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-even"><td><p>clic</p></td>
<td class="text-align:center"><p>specific_cloud_ice_water_content</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-odd"><td><p>t</p></td>
<td class="text-align:center"><p>temperature</p></td>
<td class="text-align:right"><p>[K]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-even"><td><p>2t</p></td>
<td class="text-align:center"><p>2 metre temperature</p></td>
<td class="text-align:right"><p>[K]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-odd"><td><p>tclw</p></td>
<td class="text-align:center"><p>Total column cloud liquid water</p></td>
<td class="text-align:right"><p>[kg m-2]</p></td>
<td class="text-align:right"><p>single</p></td>
</tr>
<tr class="row-even"><td><p>tciw</p></td>
<td class="text-align:center"><p>Total column cloud ice water</p></td>
<td class="text-align:right"><p>[kg m-2]</p></td>
<td class="text-align:right"><p>single</p></td>
</tr>
<tr class="row-odd"><td><p>tp</p></td>
<td class="text-align:center"><p>Total precipitation</p></td>
<td class="text-align:right"><p>[m]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
</tbody>
</table>
<div class="section" id="import-python-packages">
<h2>Import python packages<a class="headerlink" href="#import-python-packages" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Python</span></code> environment requirements: file <span class="xref myst">globalsnow.yml</span></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">python</span></code> packages from <span class="xref myst">imports.py</span></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">functions</span></code> from <span class="xref myst">functions.py</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># supress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># don&#39;t output warnings</span>

<span class="c1"># import packages</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/eosc-nordic-climate-demonstrator/work/utils/imports.py&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/eosc-nordic-climate-demonstrator/work/utils&#39;</span><span class="p">)</span>
    
<span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/eosc-nordic-climate-demonstrator/work/utils/imports.py&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/home/franzihe/Documents/Python/eosc-nordic-climate-demonstrator/work/utils/&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">imports</span> <span class="kn">import</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">intake</span><span class="p">,</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">fct</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>
<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">display_style</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.core.options.set_options at 0x7f60fbc9d100&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload imports</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="open-era5-variables">
<h2>Open ERA5 variables<a class="headerlink" href="#open-era5-variables" title="Permalink to this headline">¶</a></h2>
<p>Get the data requried for the analysis. Beforehand we downloaded the monthly averaged data on single levels and pressure levels via the Climate Data Store (CDS) infrastructure. The github repository <a class="reference external" href="https://github.com/franzihe/download_ERA5">Download ERA5</a> gives examples on how to download the data from the CDS. We use the Jupyter Notebooks <a class="reference external" href="https://github.com/franzihe/download_ERA5/blob/main/download_Amon_single_level.ipynb">download_Amon_single_level</a> and <a class="reference external" href="https://github.com/franzihe/download_ERA5/blob/main/download_Amon_pressure_level.ipynb">download_Amon_pressure_level</a>. Both, download the monthly means for the variables mentioned above between 1985 and 2014.</p>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> To download from CDS a user has to have a CDS user account, please create the account <a class="reference external" href="https://cds.climate.copernicus.eu/user/register">here</a>.</p>
</div></blockquote>
<p>The ERA5 0.25deg data is located in the folder <code class="docutils literal notranslate"><span class="pre">/input/ERA5/monthly_means/0.25deg</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/scratch/franzihe/input/ERA5/monthly_means/0.25deg/*_Amon_ERA5_*12.nc&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/input&#39;</span>
    <span class="n">output_data</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output&#39;</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/home/franzihe/Data/input/ERA5/monthly_means/0.25deg/*_Amon_ERA5_*12.nc&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="s1">&#39;/home/franzihe/Data/input/&#39;</span>
    <span class="n">output_data</span> <span class="o">=</span> <span class="s1">&#39;/home/franzihe/Data/output&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_in</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/ERA5/monthly_means/0.25deg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
<span class="n">era_out</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/ERA5/monthly_means/1deg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_id</span><span class="o">=</span><span class="p">[</span>
            <span class="s1">&#39;2t&#39;</span><span class="p">,</span>
            <span class="s1">&#39;clic&#39;</span><span class="p">,</span>
            <span class="s1">&#39;clwc&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cswc&#39;</span><span class="p">,</span>
            <span class="s1">&#39;msr&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;t&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;tciw&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tclw&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tp&#39;</span>
             <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>At the moment we have downloaded 30 years (1985-2014) for ERA5. We define start and end year to ensure to only extract the 30-year period between 1985 and 2014.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define a start and end year</p>
<p>We will load all available variables into one xarray dataset with <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset(file)</span></code> and select the time range <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/indexing.html">by name</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starty</span> <span class="o">=</span> <span class="mi">1985</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="mi">2014</span>
<span class="n">year_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Input data from ERA5 with a resolution of 0.25x0.25deg to be regridded</span>
<span class="n">era_file_in</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/*_Amon_ERA5_*12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_in</span><span class="p">,</span> <span class="p">))</span>       <span class="c1"># search for data in the local directory </span>
<span class="n">ds_era</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">era_file_in</span><span class="p">)</span>
<span class="n">ds_era</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">year_range</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create pressure array </span>
<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> 
                                                               <span class="n">dims</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">),</span> 
                                                               <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">ds_era</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>

<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="change-attributes-matching-cmip6-data">
<h2>Change attributes matching CMIP6 data<a class="headerlink" href="#change-attributes-matching-cmip6-data" title="Permalink to this headline">¶</a></h2>
<p>We will assign the attributes to the variables to make CMIP6 and ERA5 variables comperable.</p>
<p>The data <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=82870405#ERA5:datadocumentation-Monthlymeans">documentation of monthly means</a> gives information about the accumulations in monthly means (of daily means, stream=moda/edmo). Hence, the precipitation variables have been scaled to have an “effective” processing period of one day, so for accumulations in these streams</p>
<ul class="simple">
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=144"><code class="docutils literal notranslate"><span class="pre">sf</span></code></a> is in <strong>m of water per day</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span>  multiply by <strong>1000</strong> to get <strong>kg m-2 day-1</strong> or <strong>mmday-1</strong>.</p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=228"><code class="docutils literal notranslate"><span class="pre">tp</span></code></a> is in <strong>m</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>mm</strong></p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=247"><code class="docutils literal notranslate"><span class="pre">ciwc</span></code></a>, <a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=246"><code class="docutils literal notranslate"><span class="pre">clwc</span></code></a>, and <a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=76"><code class="docutils literal notranslate"><span class="pre">cswc</span></code></a> is in <strong>kg kg-1</strong>    <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>g kg-1</strong></p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=235031"><code class="docutils literal notranslate"><span class="pre">msr</span></code></a> is in <strong>kg m-2 s-1</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>86400</strong> to get <strong>mm day-1</strong></p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=79"><code class="docutils literal notranslate"><span class="pre">tciw</span></code></a> and <a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=78"><code class="docutils literal notranslate"><span class="pre">tclw</span></code></a> is in <strong>kg m-2</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>g m-2</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rename variable name to variable id</span>
<span class="c1"># variable_id[variable_id.index(&#39;2t&#39;)] = &#39;t2m&#39;</span>
<span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;clic&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;ciwc&#39;</span>

<span class="c1"># rename variable name in dataset to match variable_id</span>
<span class="n">ds_era</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;t2m&#39;</span><span class="p">:</span><span class="s1">&#39;2t&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">variable_id</span><span class="p">:</span>
    
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;ciwc&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clwc&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;cswc&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;sf&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tciw&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tclw&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tp&#39;</span><span class="p">:</span>
        <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span>
        
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;ciwc&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific cloud ice water content&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clwc&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific cloud liquid water content&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;cswc&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific snow water content&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;sf&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;mm day-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Snowfall&#39;</span><span class="p">,}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tciw&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g m-2&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total column cloud ice water&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tclw&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g m-2&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total column cloud liquid water&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tp&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total precipitation&#39;</span><span class="p">}</span>
        
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;msr&#39;</span><span class="p">:</span>
        <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">*</span><span class="mi">86400</span>
        <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;mm day-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mean snowfall rate&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="find-mixed-phase-clouds">
<h2>Find mixed-phase clouds<a class="headerlink" href="#find-mixed-phase-clouds" title="Permalink to this headline">¶</a></h2>
<p>Calculate the IWC/LWC statistics given by the values. Setting the value to 0.5 will find the level in the atmosphere where IWC and LWC are 50/50. Setting it to a value of 0.7 will find the level where IWC is 70% while LWC is 30%.</p>
<ol class="simple">
<li><p>find the fraction of IWC to LWC
$<span class="math notranslate nohighlight">\(fraction = \frac{IWC}{IWC + LWC}\)</span>$</p></li>
<li><p>find the nearest value to given IWC-fraction</p></li>
<li><p>find atmospheric pressure levels where IWC/LWC fraction occurs</p></li>
<li><p>find the index of the first atmospheric pressure level</p></li>
<li><p>use the index to select variables</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create occcurence array </span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_era</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_occurence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> 
                                                                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">,</span> 
                                                                <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics">
<h2>Create dictionary from the list of datasets we want to use for the IWC/LWC statistics<a class="headerlink" href="#create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iwc_stat</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;50&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;70&#39;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">}</span>

<span class="n">dset_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iwc_stat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;era_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">find_IWC_LWC_level</span><span class="p">(</span><span class="n">ds_era</span><span class="p">,</span> <span class="n">var1</span><span class="o">=</span><span class="s1">&#39;ciwc&#39;</span><span class="p">,</span> <span class="n">var2</span><span class="o">=</span><span class="s1">&#39;clwc&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coordinate</span><span class="o">=</span><span class="s1">&#39;level&#39;</span><span class="p">)</span>

    <span class="c1"># rename latitude and longitude</span>
    <span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;era_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">rename_coords_lon_lat</span><span class="p">(</span><span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;era_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a">
<h2>Regrid ERA5 data to common NorESM2-MM grid <a id='regrid_hz'></a><a class="headerlink" href="#regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a" title="Permalink to this headline">¶</a></h2>
<p>We want to conduct statistical analysis at the annual and seasonal timescales to determine the biases in cloud phase and precipitation (liquid and solid) for the CMIP6 models in comparison to ERA5.</p>
<p>The ERA5 data has a nominal resolution of 0.25 deg and has to be regridded to the same horizontal resolution as the NorESM2-MM. Hence we will make use of the python package <code class="docutils literal notranslate"><span class="pre">xesmf</span></code> and <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/notebooks/Compare_algorithms.html#Decreasing-resolution">decreasing resolution</a>, <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/notebooks/Masking.html?highlight=conservative#Limitations-and-warnings">Limitations and warnings</a>.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define NorESM2-MM as the reference grid <code class="docutils literal notranslate"><span class="pre">ds_out</span></code>.</p>
<p>Save all variables in one file and each variable to a <code class="docutils literal notranslate"><span class="pre">netcdf</span></code> datasets between 1985 an 2014, locally.</p>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> This can take a while, so be patient</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the output grid from NorESM</span>
<span class="n">cmip_file</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/input/cmip6_hist/1deg/grid_NorESM2-MM.nc&#39;</span>
<span class="n">ds_out</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cmip_file</span><span class="p">)</span>


<span class="c1"># create dictionary for reggridded data</span>
<span class="n">ds_gridded_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">dset_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

    <span class="c1"># select where data should be saved</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Amon_1deg_</span><span class="si">{}</span><span class="s1">01_</span><span class="si">{}</span><span class="s1">12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
    <span class="n">era_file_out</span> <span class="o">=</span> <span class="n">era_out</span> <span class="o">+</span> <span class="s1">&#39;/Amon/&#39;</span> <span class="o">+</span> <span class="n">filename</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">)</span>



    <span class="c1"># Regrid data</span>
    <span class="n">ds_in_regrid</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">regrid_data</span><span class="p">(</span><span class="n">dset_dict</span><span class="p">[</span><span class="n">keys</span><span class="p">],</span> <span class="n">ds_out</span><span class="p">)</span>

    <span class="c1"># Shift the longitude from 0--&gt;360 to -180--&gt;180 and sort by longitude and time</span>
    <span class="n">ds_in_regrid</span> <span class="o">=</span> <span class="n">ds_in_regrid</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="p">(((</span><span class="n">ds_in_regrid</span><span class="o">.</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

    <span class="c1"># create dataset with all statistics</span>
    <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="n">keys</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_in_regrid</span>

    <span class="c1"># if era_file_out in files:</span>
    <span class="c1">#     print(&#39;{} is downloaded&#39;.format(era_file_out))</span>
    <span class="c1">#     counter += 1</span>
    <span class="c1">#     print(&#39;Have regridded in total: {:} files&#39;.format(str(counter))) </span>
    <span class="c1"># else: # Save to netcdf file</span>
    <span class="n">ds_in_regrid</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;file written: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-following-cell-is-not-needed">
<h2>The following cell is not needed<a class="headerlink" href="#the-following-cell-is-not-needed" title="Permalink to this headline">¶</a></h2>
<p>Fix the regridding for the ERA5 data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_gridded_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;/scratch/franzihe/output/ERA5/monthly_means/1deg/Amon/all_Amon_1deg_198501_201412.nc&#39;</span><span class="p">)</span>

<span class="c1"># rename temperature variable</span>
<span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;t2m&#39;</span><span class="p">:</span><span class="s1">&#39;2t&#39;</span><span class="p">})</span>


<span class="c1"># create pressure array </span>
<span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">721</span><span class="p">,</span> <span class="mi">1440</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="p">),</span> 
                                                               <span class="n">dims</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">),</span> 
                                                               <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>

<span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;level&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># create occcurence array </span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_occurence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> 
                                                                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">,</span> 
                                                                <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="p">)</span>




<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iwc_stat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">find_IWC_LWC_level</span><span class="p">(</span><span class="n">ds_gridded_dict</span><span class="p">[</span><span class="s1">&#39;era&#39;</span><span class="p">],</span> <span class="n">var1</span> <span class="o">=</span><span class="s1">&#39;ciwc&#39;</span><span class="p">,</span> <span class="n">var2</span><span class="o">=</span><span class="s1">&#39;clwc&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coordinate</span><span class="o">=</span><span class="s1">&#39;level&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="connect-all-statistics-into-one-dataset-with-new-coordinate-statistic">
<h2>Connect all statistics into one Dataset with new coordinate ‘statistic’<a class="headerlink" href="#connect-all-statistics-into-one-dataset-with-new-coordinate-statistic" title="Permalink to this headline">¶</a></h2>
<p>We will create a <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> with all ERA5 data, after the interpolation to the same horizonal (and vertical) resolution. This step will make the next steps easier, as we will not need the the full dictonary key and can just use the names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_ds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dset_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">_coord</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dset_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">ds_era_025deg</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="n">_ds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">_coord</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;statistic&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_ds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_gridded_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">_coord</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_gridded_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">ds_era_1deg</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="n">_ds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">_coord</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;statistic&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="exploratory-data-analysis-a-id-exploratory-a">
<h1>3. Exploratory Data Analysis <a id='exploratory'></a><a class="headerlink" href="#exploratory-data-analysis-a-id-exploratory-a" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-seasonal-mean-spread-of-all-era5-data">
<h2>Create seasonal mean/spread of all ERA5 data<a class="headerlink" href="#create-seasonal-mean-spread-of-all-era5-data" title="Permalink to this headline">¶</a></h2>
<p>…and plot seasonal mean of each individual, like ERA5-0.25deg resolution, ERA5-1deg resolution, and the IWC/LWC statistics for 50%, 70%, 30% respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create seasonal mean of variables</span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">ds_era_1deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">seasonal_mean_std</span><span class="p">(</span><span class="n">ds_era_1deg</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>

<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_era_025deg</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">ds_era_025deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">seasonal_mean_std</span><span class="p">(</span><span class="n">ds_era_025deg</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;era&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">variable_id</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;msr&#39;</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
    <span class="c1"># for stat in ds_era_1deg.statistic.values:</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># Plot seasonal mean</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_spatial_seasonal_mean</span><span class="p">(</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">),</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> MEAN (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">))</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MEAN - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

            
        <span class="c1"># save figure to png</span>
            <span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/ERA5/&#39;</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_id</span><span class="p">,</span><span class="n">stat</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Plot seasonal mean and std</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_spatial_seasonal_mean</span><span class="p">(</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">),</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> MEAN (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">))</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MEAN - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_season_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
                <span class="n">sm</span> <span class="o">=</span> <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_season_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> 
                                                                                <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                                <span class="n">vmin</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;vmin_std&#39;</span><span class="p">)],</span> 
                                                                                <span class="n">vmax</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;vmax_std&#39;</span><span class="p">)],</span>
                                                                                <span class="n">levels</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                                                                                <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">lajolla</span><span class="p">,</span>
                                                                                <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                
            <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
            <span class="n">sb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
            <span class="n">sb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;STD - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)]),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>


            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ERA5_1985-2014_30_0.png" src="../../_images/ERA5_1985-2014_30_0.png" />
<img alt="../../_images/ERA5_1985-2014_30_1.png" src="../../_images/ERA5_1985-2014_30_1.png" />
<img alt="../../_images/ERA5_1985-2014_30_2.png" src="../../_images/ERA5_1985-2014_30_2.png" />
<img alt="../../_images/ERA5_1985-2014_30_3.png" src="../../_images/ERA5_1985-2014_30_3.png" />
<img alt="../../_images/ERA5_1985-2014_30_4.png" src="../../_images/ERA5_1985-2014_30_4.png" />
<img alt="../../_images/ERA5_1985-2014_30_5.png" src="../../_images/ERA5_1985-2014_30_5.png" />
<img alt="../../_images/ERA5_1985-2014_30_6.png" src="../../_images/ERA5_1985-2014_30_6.png" />
<img alt="../../_images/ERA5_1985-2014_30_7.png" src="../../_images/ERA5_1985-2014_30_7.png" />
<img alt="../../_images/ERA5_1985-2014_30_8.png" src="../../_images/ERA5_1985-2014_30_8.png" />
<img alt="../../_images/ERA5_1985-2014_30_9.png" src="../../_images/ERA5_1985-2014_30_9.png" />
</div>
</div>
</div>
<div class="section" id="calculate-latitude-band-mean-of-variables">
<h2>Calculate latitude band mean of variables<a class="headerlink" href="#calculate-latitude-band-mean-of-variables" title="Permalink to this headline">¶</a></h2>
<p>We will only use high latitudes and the extratropics the latitude bands are as follow:</p>
<ol class="simple">
<li><p>Southern Hemispher:</p>
<ul class="simple">
<li><p>[-30, -45)</p></li>
<li><p>[-45, -60)</p></li>
<li><p>[-60, -75)</p></li>
<li><p>[-75, -90)</p></li>
</ul>
</li>
<li><p>Northern Hemisphere:</p>
<ul class="simple">
<li><p>[30, 45)</p></li>
<li><p>[45, 60)</p></li>
<li><p>[60, 75)</p></li>
<li><p>[75, 90)</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_SH</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">);</span> <span class="n">lat_NH</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">iteration_SH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
<span class="n">iteration_NH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_SH</span><span class="p">:</span>

        <span class="c1"># ERA5 original resolution</span>
        <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># ERA5 regridded resolution</span>
        <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_NH</span><span class="p">:</span>
        <span class="c1"># ERA5 original resolution</span>
        <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># ERA5 regridded resolution</span>
        <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">statistic</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># Southern Hemisphere</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;t_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;sf_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span> <span class="o">-</span> <span class="n">step</span><span class="p">),</span> 
                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> 
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
            <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">);</span>

    <span class="c1"># Northern Hemisphere</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;t_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;sf_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span> <span class="o">+</span> <span class="n">step</span><span class="p">),</span> 
                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> 
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
            <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ERA5_1985-2014_34_0.png" src="../../_images/ERA5_1985-2014_34_0.png" />
<img alt="../../_images/ERA5_1985-2014_34_1.png" src="../../_images/ERA5_1985-2014_34_1.png" />
<img alt="../../_images/ERA5_1985-2014_34_2.png" src="../../_images/ERA5_1985-2014_34_2.png" />
<img alt="../../_images/ERA5_1985-2014_34_3.png" src="../../_images/ERA5_1985-2014_34_3.png" />
<img alt="../../_images/ERA5_1985-2014_34_4.png" src="../../_images/ERA5_1985-2014_34_4.png" />
<img alt="../../_images/ERA5_1985-2014_34_5.png" src="../../_images/ERA5_1985-2014_34_5.png" />
<img alt="../../_images/ERA5_1985-2014_34_6.png" src="../../_images/ERA5_1985-2014_34_6.png" />
<img alt="../../_images/ERA5_1985-2014_34_7.png" src="../../_images/ERA5_1985-2014_34_7.png" />
</div>
</div>
<img src="https://drive.google.com/uc?id=1zb0LHvipx8JOXLLrCxzYToJM7eNK4eaw"  height="100" />
<img src="https://reliance.rohub.org/static/media/Reliance-logo.433dc2e9.png"  height="100" />
<img src="https://www.uio.no/vrtx/decorating/resources/dist/src2/images/footer/uio-logo-en.svg"  height="100" />
<img src="https://erc.europa.eu/sites/default/files/logo_0.png"  height="100" />
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./science/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="CMIP6_hr_1985-2014.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Urban-heat-island-ERA5-Land.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Urban Heat Island effect in Fortaleza, Brazil</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Anne Fouilloux<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>