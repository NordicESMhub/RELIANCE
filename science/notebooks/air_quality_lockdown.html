
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Impact of the Covid-19 Lockdown on Air quality over Europe &#8212; Showcase Jupyter notebooks series</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Jupyter notebook comparing CAMS and air quality measurements" href="comparisons_with_air_quality_measurements.html" />
    <link rel="prev" title="Urban Heat Island effect in Fortaleza, Brazil" href="Urban-heat-island-ERA5-Land.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/reliance-icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Showcase Jupyter notebooks series</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../welcome.html">
   Welcome to RELIANCE showcase series
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../CONDUCT.html">
   Code of Conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LICENSE.html">
   LICENSE
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ADAM service jupyter notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../adam/setup.html">
   ADAM service
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../adam/notebooks/MOD_AquaCHL_ADAM.html">
     Using ADAM-API to access MODIS Aqua CHL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../adam/notebooks/UERRA_ADAM.html">
     Using ADAM-API to access UERRA regional reanalysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ROHUB service jupyter notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../rohub/setup.html">
   ROHUB service
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../rohub/notebooks/ROHub-library-prod-demo.html">
     Example to use Rohub from Jupyter notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../rohub/notebooks/Sharing-files-EGI-DataHub.html">
     WORKING WITH EGI DATAHUB
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Scientific showcase series
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../eosc-future.html">
   EOSC-Future demo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/README.html">
     Demo for EOSC-Future
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE-Datacube-featuring-EOSC.html">
     Using CAMS European air quality analysis from Copernicus Atmosphere Monitoring with RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_France_PM10.html">
     PM10 over France with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Italy_NO2.html">
     NO2 over Italy with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway-Viken_NO2.html">
     NO2 over Viken &amp; Oslo (Norway) with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway-Viken_PM10.html">
     PM10 over Viken &amp; Oslo (Norway) with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway-Viken_PM25.html">
     PM2.5 over Viken &amp; Oslo (Norway) with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Norway_PM10.html">
     PM10 over Norway with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../demo-eosc-future/RELIANCE_Spain_NO2_month.html">
     NO2 over Spain with CAMS European air quality analysis using RELIANCE services
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro.html">
   Notebooks from researchers
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="CMIP6_hr_1985-2014.html">
     Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ERA5_1985-2014.html">
     Cloud feedback Analysis with ERA5 high-resolution (~0.25deg) monthly means
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Urban-heat-island-ERA5-Land.html">
     Urban Heat Island effect in Fortaleza, Brazil
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Impact of the Covid-19 Lockdown on Air quality over Europe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="comparisons_with_air_quality_measurements.html">
     Jupyter notebook comparing CAMS and air quality measurements
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/science/notebooks/air_quality_lockdown.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/NordicESMHub/RELIANCE"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/NordicESMHub/RELIANCE/issues/new?title=Issue%20on%20page%20%2Fscience/notebooks/air_quality_lockdown.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/NordicESMHub/RELIANCE/main?urlpath=tree/content/science/notebooks/air_quality_lockdown.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-1-background-a-background">
   <a id="1.Background">
   </a>
   Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-3-python-packages-a-python-packages">
   <a id="3.Python_Packages">
   </a>
   Python packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-2-data-management-plan-a-data-management-plan">
   <a id="2.Data_Management_Plan">
   </a>
   Data Management Plan
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authors">
     Authors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-university-of-olso-as-publishers">
     Add the University of Olso as publishers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-funding">
     Add the funding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choose-a-license-for-your-fair-digital-object">
     Choose a license for your FAIR digital Object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organize-my-data">
     Organize my data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-4-adam-uthentication-a-adam-api-authentication">
   <a id="4.Adam_uthentication">
   </a>
   ADAM API Authentication
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-adam-key-from-a-local-file">
     Get ADAM Key from a local file
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-5-datasets-discovery-a-datasets-discovery">
   <a id="5.Datasets_Discovery">
   </a>
   Datasets Discovery
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-filter-datasets">
     Pre-filter datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cam-surface-no2">
     CAM Surface NO2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#particule-matter-2-5-m-pm2-5">
     Particule matter &lt; 2.5 µm (PM2.5)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#surface-ozone-o3">
     Surface Ozone (O3)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-6-products-discovery-a-products-discovery">
   <a id="6.Products_Discovery">
   </a>
   Products Discovery
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-availability-of-no2-pm2-5-and-o3-for-march-2019-to-june-2021-over-the-whole-available-area">
     Check availability of NO2, PM2.5 and O3 for March 2019 to June 2021 over the whole available area
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discover-no2-products">
       Discover NO2 products
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discover-pm2-5-products">
       Discover PM2.5 products
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discover-o3-products">
       Discover O3 products
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-7-data-access-a-data-access">
   <a id="7.Data_Access">
   </a>
   Data Access
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-a-function-to-select-a-time-range-geometry-and-get-data">
     Define a function to select a time range, geometry and get data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reformat-geometry-for-adam-api">
       Reformat geometry for ADAM API
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-no2-products-for-march-june-in-2019-2020-and-2021">
     Get NO2 Products for March-June in 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-pm2-5-products-for-march-june-in-2019-2020-and-2021">
     Get PM2.5 Products for March-June in 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-o3-products-for-march-june-in-2019-2020-and-2021">
     Get O3 Products for March-June in 2019, 2020 and 2021
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-8-data-analysis-visualization-a-data-analysis-and-visualization">
   <a id="8.Data_Analysis_Visualization">
   </a>
   Data Analysis and Visualization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unzip-no2-pm2-5-and-o3-data">
     Unzip NO2, PM2.5 and O3 data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-no2-pm2-5-and-o3-data-as-xarray">
       Read NO2, PM2.5 and O3 data as Xarray
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utility-functions-for-regridding-and-reading-data-into-xarrays">
       Utility functions for regridding and reading data into Xarrays
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#select-the-resulting-output-grid">
         Select the resulting output grid
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#pick-a-recent-date-for-getting-the-output-grid">
         pick a recent date for getting the output grid
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#function-to-get-the-time-from-the-filename">
         Function to get the time from the filename
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#function-to-read-and-regrid-data">
         Function to read and regrid data
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#function-to-plot-one-single-date">
       Function to plot one single date
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#function-to-plot-several-years">
       Function to plot several years
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-no2">
       Read NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-one-date-for-no2-here-1st-may-2020-e-g-at-the-end-of-the-lockdown">
       Plot one date for NO2 (here 1st May 2020 e.g. at the end of the lockdown)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-pm2-5">
       Read PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-o3">
       Read O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-analysis-compute-yearly-average-and-maximum-for-the-selected-months">
     Data analysis - Compute yearly average and maximum for the selected months.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-analysis-for-no2">
       Data analysis for NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-analysis-for-pm2-5">
       Data analysis for PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-analysis-for-o3">
       Data analysis for O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-average-and-maximum-values-over-march-june-for-2019-2020-and-2021">
     Visualize average and Maximum values over March-June for 2019, 2020 and 2021
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-no2">
       Maximum NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-no2">
       Average NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-pm2-5">
       Maximum PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-pm2-5">
       Average PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-o3">
       Maximum O3
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-o3">
       Average O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-of-no2-pm2-5-and-o3-at-specific-locations">
     Time series of NO2, PM2.5 and O3 at specific locations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualize-selected-locations-on-a-map">
       Visualize selected locations on a map
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-daily-averages-for-all-the-selected-locations">
     Plot daily averages for all the selected locations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pm2-5">
       PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#o3">
       O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#years-2019-2020-and-2021-march-june-average-at-each-selected-location">
     3 years (2019, 2020 and 2021) March-June average at each selected location
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#no2">
     NO2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     PM2.5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     O3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-9-discussion-a-discussion">
   <a id="9.Discussion">
   </a>
   Discussion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-10-conclusion-a-conclusion">
   <a id="10.Conclusion">
   </a>
   Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-11-research-object-a-creation-of-research-object-in-rohub">
   <a id="11.Research_Object">
   </a>
   Creation of research Object in Rohub
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authenticate">
     Authenticate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creation-of-a-new-executable-research-object">
     Creation of a new executable Research Object
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Impact of the Covid-19 Lockdown on Air quality over Europe</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-1-background-a-background">
   <a id="1.Background">
   </a>
   Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-3-python-packages-a-python-packages">
   <a id="3.Python_Packages">
   </a>
   Python packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-2-data-management-plan-a-data-management-plan">
   <a id="2.Data_Management_Plan">
   </a>
   Data Management Plan
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authors">
     Authors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-university-of-olso-as-publishers">
     Add the University of Olso as publishers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-funding">
     Add the funding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choose-a-license-for-your-fair-digital-object">
     Choose a license for your FAIR digital Object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organize-my-data">
     Organize my data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-4-adam-uthentication-a-adam-api-authentication">
   <a id="4.Adam_uthentication">
   </a>
   ADAM API Authentication
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-adam-key-from-a-local-file">
     Get ADAM Key from a local file
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-5-datasets-discovery-a-datasets-discovery">
   <a id="5.Datasets_Discovery">
   </a>
   Datasets Discovery
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-filter-datasets">
     Pre-filter datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cam-surface-no2">
     CAM Surface NO2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#particule-matter-2-5-m-pm2-5">
     Particule matter &lt; 2.5 µm (PM2.5)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#surface-ozone-o3">
     Surface Ozone (O3)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-6-products-discovery-a-products-discovery">
   <a id="6.Products_Discovery">
   </a>
   Products Discovery
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-availability-of-no2-pm2-5-and-o3-for-march-2019-to-june-2021-over-the-whole-available-area">
     Check availability of NO2, PM2.5 and O3 for March 2019 to June 2021 over the whole available area
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discover-no2-products">
       Discover NO2 products
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discover-pm2-5-products">
       Discover PM2.5 products
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discover-o3-products">
       Discover O3 products
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-7-data-access-a-data-access">
   <a id="7.Data_Access">
   </a>
   Data Access
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-a-function-to-select-a-time-range-geometry-and-get-data">
     Define a function to select a time range, geometry and get data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reformat-geometry-for-adam-api">
       Reformat geometry for ADAM API
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-no2-products-for-march-june-in-2019-2020-and-2021">
     Get NO2 Products for March-June in 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-pm2-5-products-for-march-june-in-2019-2020-and-2021">
     Get PM2.5 Products for March-June in 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-o3-products-for-march-june-in-2019-2020-and-2021">
     Get O3 Products for March-June in 2019, 2020 and 2021
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-8-data-analysis-visualization-a-data-analysis-and-visualization">
   <a id="8.Data_Analysis_Visualization">
   </a>
   Data Analysis and Visualization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unzip-no2-pm2-5-and-o3-data">
     Unzip NO2, PM2.5 and O3 data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-no2-pm2-5-and-o3-data-as-xarray">
       Read NO2, PM2.5 and O3 data as Xarray
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utility-functions-for-regridding-and-reading-data-into-xarrays">
       Utility functions for regridding and reading data into Xarrays
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#select-the-resulting-output-grid">
         Select the resulting output grid
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#pick-a-recent-date-for-getting-the-output-grid">
         pick a recent date for getting the output grid
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#function-to-get-the-time-from-the-filename">
         Function to get the time from the filename
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#function-to-read-and-regrid-data">
         Function to read and regrid data
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#function-to-plot-one-single-date">
       Function to plot one single date
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#function-to-plot-several-years">
       Function to plot several years
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-no2">
       Read NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-one-date-for-no2-here-1st-may-2020-e-g-at-the-end-of-the-lockdown">
       Plot one date for NO2 (here 1st May 2020 e.g. at the end of the lockdown)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-pm2-5">
       Read PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-o3">
       Read O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-analysis-compute-yearly-average-and-maximum-for-the-selected-months">
     Data analysis - Compute yearly average and maximum for the selected months.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-analysis-for-no2">
       Data analysis for NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-analysis-for-pm2-5">
       Data analysis for PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-analysis-for-o3">
       Data analysis for O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-average-and-maximum-values-over-march-june-for-2019-2020-and-2021">
     Visualize average and Maximum values over March-June for 2019, 2020 and 2021
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-no2">
       Maximum NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-no2">
       Average NO2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-pm2-5">
       Maximum PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-pm2-5">
       Average PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-o3">
       Maximum O3
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-o3">
       Average O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-of-no2-pm2-5-and-o3-at-specific-locations">
     Time series of NO2, PM2.5 and O3 at specific locations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualize-selected-locations-on-a-map">
       Visualize selected locations on a map
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-daily-averages-for-all-the-selected-locations">
     Plot daily averages for all the selected locations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pm2-5">
       PM2.5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#o3">
       O3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#years-2019-2020-and-2021-march-june-average-at-each-selected-location">
     3 years (2019, 2020 and 2021) March-June average at each selected location
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#no2">
     NO2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     PM2.5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     O3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-9-discussion-a-discussion">
   <a id="9.Discussion">
   </a>
   Discussion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-10-conclusion-a-conclusion">
   <a id="10.Conclusion">
   </a>
   Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-id-11-research-object-a-creation-of-research-object-in-rohub">
   <a id="11.Research_Object">
   </a>
   Creation of research Object in Rohub
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authenticate">
     Authenticate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creation-of-a-new-executable-research-object">
     Creation of a new executable Research Object
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><img src='https://www.reliance-project.eu/wp-content/uploads/2021/03/Asset-8mdpi.svg' alt='Layout' align='left' width='25%'></img>
<img src='https://media-exp1.licdn.com/dms/image/C560BAQFFDze0s3l-pQ/company-logo_200_200/0?e=2159024400&v=beta&t=jG_sh9NpwE6yc2TspIcL2YUR2X7OBzTrRSu6w7sNYtc' alt='Layout' align='right' width='10%'></img>
<br>
<br>
<br>
<br>
<br></p>
<div class="tex2jax_ignore mathjax_ignore section" id="impact-of-the-covid-19-lockdown-on-air-quality-over-europe">
<h1>Impact of the Covid-19 Lockdown on Air quality over Europe<a class="headerlink" href="#impact-of-the-covid-19-lockdown-on-air-quality-over-europe" title="Permalink to this headline">¶</a></h1>
<p><svg version="1.1" width="16" height="16" class="octicon octicon-tag" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"></path></svg>
<span class="sphinx-bs badge badge-primary">copernicus</span>
<span class="sphinx-bs badge badge-secondary">air-quality</span></p>
<p><a class="reference external" href="https://w3id.org/ro-id/53aa90bf-c593-4e6d-923f-d4711ac4b0e1"><img alt="RoHub - FAIR Executable Research Object" src="https://img.shields.io/badge/RoHub-FAIR_Executable_Research_Object-2ea44f?logo=Open+Access&amp;logoColor=blue" /></a></p>
<p><a href="https://orcid.org/0000-0002-1784-2920">Anne Fouilloux</a>, <a href="https://orcid.org/0000-0002-8763-1643">Jean Iaquinta</a></p>
<p><b>This Jupyter notebook is distributed under <a href="https://choosealicense.com/licenses/mit/">MIT License</a></b></p>
<div class="alert alert-success alert-info">
<b>This Jupyter notebook shows how to discover RELIANCE datacube resources (spatial and temporal search and subsetting) and ROHUB to create Research Object</b>
</div><p>This notebook shows how to discover and access the <a class="reference external" href="https://ads.atmosphere.copernicus.eu/#%21/home">Copernicus Atmosphere Monitoring</a> products available in the <strong>RELIANCE</strong> datacube resources, by using the functionalities provided in the <font color='blue'> <strong>Adam API</strong> </font>. The process is structured in 6 steps, including example of data analysis and visualization with the Python libraries installed in the Jupyter environment.</p>
<ul class="simple">
<li><p><a class="reference external" href="#1.Background">1. Background</a></p></li>
<li><p><a class="reference external" href="#2.Python_Packages">2. Python Packages</a></p></li>
<li><p><a class="reference external" href="#3.Data_Management_Plan">3. Data Management Plan</a></p></li>
<li><p><a class="reference external" href="#4.Adam_uthentication">4. ADAM API Authentication</a></p></li>
<li><p><a class="reference external" href="#5.Datasets_Discovery">5. Datasets Discovery</a></p></li>
<li><p><a class="reference external" href="#6.Products_Discovery">6. Products Discovery</a></p></li>
<li><p><a class="reference external" href="#7.Data_Access">7. Data Access</a></p></li>
<li><p><a class="reference external" href="#8.Data_Analysis_Visualization">8. Data Analysis and Visualization</a></p></li>
<li><p><a class="reference external" href="#9.Discussion">9. Discussion</a></p></li>
<li><p><a class="reference external" href="#10.Conclusion">10. Conclusion</a></p></li>
<li><p><a class="reference external" href="#11.Research_Object">11. Share our work as a Research Object</a></p></li>
</ul>
<div class="section" id="a-id-1-background-a-background">
<h2><a id=1.Background></a> Background<a class="headerlink" href="#a-id-1-background-a-background" title="Permalink to this headline">¶</a></h2>
<p>The COVID-19 pandemic has led to significant reductions in economic activity, especially during lockdowns. Several studies has shown that the concentration of nitrogen dioxyde and particulate matter levels have reduced during lockdown events. Reductions in transportation sector emissions are most likely largely responsible for the NO2 anomalies. In this study, we analyze the impact of lockdown events on the air quality using data from <a class="reference external" href="https://ads.atmosphere.copernicus.eu/">Copernicus Atmosphere Monitoring Service</a>.</p>
</div>
<div class="section" id="a-id-3-python-packages-a-python-packages">
<h2><a id=3.Python_Packages></a> Python packages<a class="headerlink" href="#a-id-3-python-packages-a-python-packages" title="Permalink to this headline">¶</a></h2>
<p>Additional packages need to be installed to run this Jupyter notebook on default EGI notebook environment</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">adamapi</span> <span class="n">rohub</span> <span class="n">geojson_rewind</span> <span class="n">cmaps</span> <span class="n">cmcrameri</span> <span class="n">seaborn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: adamapi in /opt/conda/lib/python3.8/site-packages (2.0.11)
Requirement already satisfied: rohub in /opt/conda/lib/python3.8/site-packages (1.0.7)
Requirement already satisfied: geojson_rewind in /opt/conda/lib/python3.8/site-packages (1.0.3)
Requirement already satisfied: cmaps in /opt/conda/lib/python3.8/site-packages (1.0.5)
Requirement already satisfied: cmcrameri in /opt/conda/lib/python3.8/site-packages (1.4)
Requirement already satisfied: seaborn in /opt/conda/lib/python3.8/site-packages (0.11.1)
Requirement already satisfied: requests&gt;=2.22.0 in /opt/conda/lib/python3.8/site-packages (from adamapi) (2.25.1)
Requirement already satisfied: imageio in /opt/conda/lib/python3.8/site-packages (from adamapi) (2.9.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/conda/lib/python3.8/site-packages (from requests&gt;=2.22.0-&gt;adamapi) (2021.10.8)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /opt/conda/lib/python3.8/site-packages (from requests&gt;=2.22.0-&gt;adamapi) (1.26.4)
Requirement already satisfied: chardet&lt;5,&gt;=3.0.2 in /opt/conda/lib/python3.8/site-packages (from requests&gt;=2.22.0-&gt;adamapi) (4.0.0)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /opt/conda/lib/python3.8/site-packages (from requests&gt;=2.22.0-&gt;adamapi) (2.10)
Requirement already satisfied: pandas in /opt/conda/lib/python3.8/site-packages (from rohub) (1.2.4)
Requirement already satisfied: numpy in /opt/conda/lib/python3.8/site-packages (from cmaps) (1.19.5)
Requirement already satisfied: matplotlib in /opt/conda/lib/python3.8/site-packages (from cmaps) (3.5.1)
Requirement already satisfied: scipy&gt;=1.0 in /opt/conda/lib/python3.8/site-packages (from seaborn) (1.6.3)
Requirement already satisfied: fonttools&gt;=4.22.0 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (4.30.0)
Requirement already satisfied: packaging&gt;=20.0 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (20.9)
Requirement already satisfied: cycler&gt;=0.10 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (0.10.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (1.3.1)
Requirement already satisfied: pillow&gt;=6.2.0 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (8.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (2.8.1)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /opt/conda/lib/python3.8/site-packages (from matplotlib-&gt;cmaps) (2.4.7)
Requirement already satisfied: six in /opt/conda/lib/python3.8/site-packages (from cycler&gt;=0.10-&gt;matplotlib-&gt;cmaps) (1.15.0)
Requirement already satisfied: pytz&gt;=2017.3 in /opt/conda/lib/python3.8/site-packages (from pandas-&gt;rohub) (2021.1)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-2-data-management-plan-a-data-management-plan">
<h2><a id=2.Data_Management_Plan></a> Data Management Plan<a class="headerlink" href="#a-id-2-data-management-plan-a-data-management-plan" title="Permalink to this headline">¶</a></h2>
<div class="section" id="authors">
<h3>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Make sure you first register to RoHub at <a class="reference external" href="https://reliance.rohub.org/">https://reliance.rohub.org/</a>.</p></li>
<li><p>We recommend you use your ORCID identifier to login and register to EOSC services.</p></li>
<li><p>In the list of authors, add any co-authors using the email address they used when they registered in RoHub.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">author_emails</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;annefou@geo.uio.no&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-the-university-of-olso-as-publishers">
<h3>Add the University of Olso as publishers<a class="headerlink" href="#add-the-university-of-olso-as-publishers" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">UiO_organization</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;org_id&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.uio.no/english/&quot;</span><span class="p">,</span> 
                     <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;University of Oslo&quot;</span><span class="p">,</span> 
                     <span class="s2">&quot;agent_type&quot;</span><span class="p">:</span> <span class="s2">&quot;organization&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;ror_identifier&quot;</span><span class="p">:</span><span class="s2">&quot;01xtthb56&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;organization_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.uio.no/english/&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_publishers</span> <span class="o">=</span> <span class="p">[</span><span class="n">UiO_organization</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_copyright_holders</span> <span class="o">=</span> <span class="p">[</span><span class="n">UiO_organization</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-the-funding">
<h3>Add the funding<a class="headerlink" href="#add-the-funding" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>if your work is not funded set</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">funded_by</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">funded_by</span> <span class="o">=</span> <span class="p">{</span>
<span class="s2">&quot;grant_id&quot;</span><span class="p">:</span> <span class="s2">&quot;101017502&quot;</span><span class="p">,</span>
<span class="s2">&quot;grant_Name&quot;</span><span class="p">:</span> <span class="s2">&quot;RELIANCE&quot;</span><span class="p">,</span>
<span class="s2">&quot;grant_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Research Lifecycle Management for Earth Science Communities and Copernicus Users&quot;</span><span class="p">,</span>
<span class="s2">&quot;funder_name&quot;</span><span class="p">:</span> <span class="s2">&quot;European Commission&quot;</span><span class="p">,</span>
<span class="s2">&quot;funder_doi&quot;</span><span class="p">:</span> <span class="s2">&quot;10.13039/501100000781&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="choose-a-license-for-your-fair-digital-object">
<h3>Choose a license for your FAIR digital Object<a class="headerlink" href="#choose-a-license-for-your-fair-digital-object" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>We choose MIT license because we are creating an executable Research Object.</p></li>
<li><p>To see all the available licenses:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rohub</span>
<span class="n">licenses</span> <span class="o">=</span> <span class="n">rohub</span><span class="o">.</span><span class="n">list_available_licenses</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">licenses</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>You can also add your own custom license (see <a class="reference external" href="https://reliance-eosc.github.io/ROHUB-API_documentation/html/index.html">RoHub documentation</a>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">license</span> <span class="o">=</span> <span class="s1">&#39;MIT&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="organize-my-data">
<h3>Organize my data<a class="headerlink" href="#organize-my-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Define a prefix for my project (you may need to adjust it for your own usage on your infrastructure).</p>
<ul>
<li><p>input folder where all the data used as input to my Jupyter Notebook is stored (and eventually shared)</p></li>
<li><p>output folder where all the results to keep are stored</p></li>
<li><p>tool folder where all the tools, including this Jupyter Notebook will be copied for sharing</p></li>
</ul>
</li>
<li><p>Create all corresponding folders</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WORKDIR_FOLDER</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s2">&quot;datahub/Reliance/Climate&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WORKDIR FOLDER: &quot;</span><span class="p">,</span> <span class="n">WORKDIR_FOLDER</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WORKDIR FOLDER:  /home/jovyan/datahub/Reliance/Climate
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">INPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WORKDIR_FOLDER</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="n">OUTPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WORKDIR_FOLDER</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="n">TOOL_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WORKDIR_FOLDER</span><span class="p">,</span> <span class="s1">&#39;tool&#39;</span><span class="p">)</span>

<span class="n">list_folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">INPUT_DATA_DIR</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">,</span> <span class="n">TOOL_DATA_DIR</span><span class="p">]</span>

<span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">list_folders</span><span class="p">:</span>
    <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-4-adam-uthentication-a-adam-api-authentication">
<h2><a id=4.Adam_uthentication></a> ADAM API Authentication<a class="headerlink" href="#a-id-4-adam-uthentication-a-adam-api-authentication" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning alert-info">
    The following lines of code will show the personal <b>Adam API-Key</b> of the user and the endpoint currently in use, that provides access to the products in the related catalogue. At the end of the execution, if the authentication process is successfull the personal token and the expiration time should be returned as outputs.
</div><div class="section" id="get-adam-key-from-a-local-file">
<h3>Get ADAM Key from a local file<a class="headerlink" href="#get-adam-key-from-a-local-file" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>get an account to <a class="reference external" href="https://reliance.adamplatform.eu/">https://reliance.adamplatform.eu/</a> (use ORCID to authenticate)</p></li>
<li><p>get your your ADAM API key (click on your profile after you login and copy “Api Key”)</p></li>
<li><p>make sure you save your ADAM API key in a file $HOME/adam-key</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adam_key</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span><span class="s2">&quot;adam-key&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">adamapi</span> <span class="k">as</span> <span class="nn">adam</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">Auth</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">setKey</span><span class="p">(</span><span class="n">adam_key</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">setAdamCore</span><span class="p">(</span><span class="s1">&#39;https://reliance.adamplatform.eu&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">authorize</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;expires_at&#39;: &#39;2022-05-30T12:59:27.013Z&#39;,
 &#39;access_token&#39;: &#39;0292b3ddca1b4cf0870f27092ef2da98&#39;,
 &#39;refresh_token&#39;: &#39;61ab3bb775484c07a7168c8f8e83b5d3&#39;,
 &#39;expires_in&#39;: 3600}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-5-datasets-discovery-a-datasets-discovery">
<h2><a id=5.Datasets_Discovery></a> Datasets Discovery<a class="headerlink" href="#a-id-5-datasets-discovery-a-datasets-discovery" title="Permalink to this headline">¶</a></h2>
<p>After the authorization, the user can browse the whole catalogue, structured as a JSON object after a pagination process,  displaying all the available datasets. This operation can be executed with the <font color='blue'> <strong>getDatasets()</strong> </font> function without including any argument. Some lines of code should be added to parse the Json object and extract the names of the datasets.The Json object can be handled as a Python dictionary.</p>
<div class="section" id="pre-filter-datasets">
<h3>Pre-filter datasets<a class="headerlink" href="#pre-filter-datasets" title="Permalink to this headline">¶</a></h3>
<p>We will discover all the available datasets in the ADAM platform but will only print elements of interest <strong>EU_CAMS</strong> e.g. <a class="reference external" href="https://ads.atmosphere.copernicus.eu/cdsapp#%21/dataset/cams-europe-air-quality-forecasts?tab=overview">European air quality datasets</a> from Copernicus Atmosphere Monitoring Service</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_datasets</span> <span class="o">=</span> <span class="s1">&#39;CAMS&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">adamapi</span> <span class="kn">import</span> <span class="n">Datasets</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">catalogue</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">getDatasets</span><span class="p">()</span>

<span class="c1"># Extracting the size of the catalogue</span>

<span class="n">total</span> <span class="o">=</span> <span class="n">catalogue</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;totalResults&#39;</span><span class="p">]</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">catalogue</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;itemsPerPage&#39;</span><span class="p">]</span>
<span class="n">pages</span> <span class="o">=</span> <span class="n">total</span><span class="o">//</span><span class="n">items</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[1m&#39;</span> <span class="o">+</span> <span class="s1">&#39;List of available datasets:&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0m&#39;</span><span class="p">)</span>

<span class="c1"># Extracting the list of datasets across the whole catalogue</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pages</span><span class="p">):</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">getDatasets</span><span class="p">(</span><span class="n">page</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">page</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]:</span> 
        <span class="k">if</span> <span class="n">filter_datasets</span> <span class="ow">in</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1m&quot;</span> <span class="o">+</span> <span class="s2">&quot; --&gt; datasetId &quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[0m&quot;</span> <span class="o">+</span> <span class="s2">&quot;= &quot;</span> <span class="o">+</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;datasetId&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------
<span class=" -Color -Color-Bold">List of available datasets:</span>

CAMS European air quality forecasts: C2H3NO5<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69619:EU_CAMS_SURFACE_C2H3NO5_G
CAMS European air quality forecasts: CO<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69620:EU_CAMS_SURFACE_CO_G
EU_CAMS_SURFACE_NH3_G<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69621:EU_CAMS_SURFACE_NH3_G
CAMS European air quality forecasts: NMVOC<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69622:EU_CAMS_SURFACE_NMVOC_G
CAMS European air quality forecasts: NO2<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69623:EU_CAMS_SURFACE_NO2_G
EU_CAMS_SURFACE_NO_G<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69624:EU_CAMS_SURFACE_NO_G
CAMS European air quality forecasts: O3<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69625:EU_CAMS_SURFACE_O3_G
CAMS European air quality forecasts: PM10<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69626:EU_CAMS_SURFACE_PM10_G
CAMS European air quality forecasts: PM25<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69627:EU_CAMS_SURFACE_PM25_G
CAMS European air quality forecasts: REC<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69628:EU_CAMS_SURFACE_REC_G
CAMS European air quality forecasts: SIA<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69629:EU_CAMS_SURFACE_SIA_G
CAMS European air quality forecasts: SO2<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69630:EU_CAMS_SURFACE_SO2_G
CAMS European air quality forecasts: TEC<span class=" -Color -Color-Bold"> --&gt; datasetId </span>= 69631:EU_CAMS_SURFACE_TEC_G
</pre></div>
</div>
</div>
</div>
<p>We are interested by 3 different products:</p>
<ul class="simple">
<li><p>Nitrogen Dioxyde (NO2=</p></li>
<li><p>Particulate matter &lt; 2.5 µm (PM2.5)</p></li>
<li><p>Ozone concentration (O3)</p></li>
</ul>
<p>So we will discover <strong>EU_CAMS_SURFACE_NO2_G</strong>, <strong>EU_CAMS_SURFACE_PM25_G</strong> and <strong>EU_CAMS_SURFACE_O3_G</strong> and print the metadata of each dataset, showing the data provenance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="n">datasetID</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[1;34m&#39;</span> <span class="o">+</span> <span class="s1">&#39;Metadata of &#39;</span> <span class="o">+</span> <span class="n">datasetID</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0;0m&#39;</span><span class="p">)</span>
    
    <span class="n">paged</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">getDatasets</span><span class="p">(</span><span class="n">datasetID</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">paged</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1m&quot;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[0m&quot;</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">paged</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cam-surface-no2">
<h3>CAM Surface NO2<a class="headerlink" href="#cam-surface-no2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasetID_NO2</span> <span class="o">=</span> <span class="s1">&#39;69623:EU_CAMS_SURFACE_NO2_G&#39;</span>
<span class="n">metadata_NO2</span> <span class="o">=</span> <span class="n">get_metadata</span><span class="p">(</span><span class="n">datasetID_NO2</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">Metadata of 69623:EU_CAMS_SURFACE_NO2_G:</span>

<span class=" -Color -Color-Bold">datasetId</span>: 69623:EU_CAMS_SURFACE_NO2_G
<span class=" -Color -Color-Bold">creationDate</span>: 2021-07-12T00:00:00Z
<span class=" -Color -Color-Bold">dataType</span>: Float32
<span class=" -Color -Color-Bold">epsg</span>: 4326
<span class=" -Color -Color-Bold">keywords</span>: []
<span class=" -Color -Color-Bold">license</span>: {&#39;documentationUrl&#39;: &#39;&#39;, &#39;dataProviderName&#39;: &#39;ADS&#39;, &#39;dataProviderUrl&#39;: &#39;&#39;, &#39;licenseId&#39;: &#39;&#39;, &#39;dataPolicy&#39;: &#39;&#39;, &#39;doi&#39;: &#39;&#39;, &#39;credits&#39;: &#39;&#39;}
<span class=" -Color -Color-Bold">maxValue</span>: [1.354510459350422e-07]
<span class=" -Color -Color-Bold">minValue</span>: [0.0]
<span class=" -Color -Color-Bold">numberOfRecords</span>: 135590
<span class=" -Color -Color-Bold">profile</span>: {&#39;profileSchema&#39;: &#39;eo_profile_schema.json&#39;, &#39;name&#39;: &#39;Earth Observation&#39;, &#39;mission&#39;: &#39;CAMS&#39;, &#39;sensor&#39;: &#39;CAMS&#39;, &#39;processingLevel&#39;: &#39;forecast&#39;, &#39;instrument&#39;: &#39;&#39;, &#39;platform&#39;: &#39;&#39;}
<span class=" -Color -Color-Bold">resolutionUnit</span>: degree
<span class=" -Color -Color-Bold">temporalResolution</span>: Hourly
<span class=" -Color -Color-Bold">unit</span>: 
<span class=" -Color -Color-Bold">unitDescription</span>: 
<span class=" -Color -Color-Bold">updateDate</span>: 2022-05-29T12:03:27Z
<span class=" -Color -Color-Bold">geometry</span>: {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}
<span class=" -Color -Color-Bold">resolutions</span>: [0.1]
<span class=" -Color -Color-Bold">anyText</span>: 4326,ESA,Daily,ESA
<span class=" -Color -Color-Bold">applications</span>: [&#39;Atmosphere&#39;]
<span class=" -Color -Color-Bold">datasetManager</span>: govoni@meeo.it
<span class=" -Color -Color-Bold">datasetManagerOrganisation</span>: meeo
<span class=" -Color -Color-Bold">description</span>: CAMS NITROGEN DIOXIDE
<span class=" -Color -Color-Bold">title</span>: CAMS European air quality forecasts: NO2
<span class=" -Color -Color-Bold">noDataValue</span>: 0
<span class=" -Color -Color-Bold">timeReferenceSystem</span>: UTC
<span class=" -Color -Color-Bold">units</span>: µg m-3
<span class=" -Color -Color-Bold">unitsDescription</span>: nitrogen dioxide
<span class=" -Color -Color-Bold">services</span>: [&#39;MWCS&#39;, &#39;ADAM&#39;, &#39;AdamApi&#39;]
<span class=" -Color -Color-Bold">technicalManager</span>: govoni@meeo.it
<span class=" -Color -Color-Bold">filtersEnabled</span>: {&#39;type&#39;: &#39;object&#39;, &#39;title&#39;: &#39;Dataset filters&#39;, &#39;properties&#39;: {&#39;startDate&#39;: {&#39;title&#39;: &#39;Start Date&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date&#39;, &#39;text_rule&#39;: &#39;false&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;false&#39;, &#39;pattern&#39;: &#39;^d{4}-[01]d-[0-3]d(T[0-2]d:[0-9]d:[0-9]dZ)?$&#39;}, &#39;endDate&#39;: {&#39;title&#39;: &#39;End Date&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;text_rule&#39;: &#39;false&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;false&#39;, &#39;pattern&#39;: &#39;^d{4}-[01]d-[0-3]d(T[0-2]d:[0-9]d:[0-9]dZ)?$&#39;}}}
<span class=" -Color -Color-Bold">previews</span>: 
<span class=" -Color -Color-Bold">startDate</span>: 2018-07-12T00:00:00Z
<span class=" -Color -Color-Bold">endDate</span>: 2022-05-28T23:00:00Z
<span class=" -Color -Color-Bold">accounting</span>: {&#39;unit&#39;: 0.0032}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="particule-matter-2-5-m-pm2-5">
<h3>Particule matter &lt; 2.5 µm (PM2.5)<a class="headerlink" href="#particule-matter-2-5-m-pm2-5" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasetID_PM2_5</span> <span class="o">=</span> <span class="s1">&#39;69627:EU_CAMS_SURFACE_PM25_G&#39;</span>
<span class="n">metadata_PM2_5</span> <span class="o">=</span> <span class="n">get_metadata</span><span class="p">(</span><span class="n">datasetID_PM2_5</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">Metadata of 69627:EU_CAMS_SURFACE_PM25_G:</span>

<span class=" -Color -Color-Bold">datasetId</span>: 69627:EU_CAMS_SURFACE_PM25_G
<span class=" -Color -Color-Bold">creationDate</span>: 2021-07-12T03:00:00Z
<span class=" -Color -Color-Bold">dataType</span>: Float32
<span class=" -Color -Color-Bold">epsg</span>: 4326
<span class=" -Color -Color-Bold">keywords</span>: []
<span class=" -Color -Color-Bold">license</span>: {&#39;documentationUrl&#39;: &#39;&#39;, &#39;dataProviderName&#39;: &#39;ADS&#39;, &#39;dataProviderUrl&#39;: &#39;&#39;, &#39;licenseId&#39;: &#39;&#39;, &#39;dataPolicy&#39;: &#39;&#39;, &#39;doi&#39;: &#39;&#39;, &#39;credits&#39;: &#39;&#39;}
<span class=" -Color -Color-Bold">maxValue</span>: [709.8012084960938]
<span class=" -Color -Color-Bold">minValue</span>: [0.0]
<span class=" -Color -Color-Bold">numberOfRecords</span>: 33830
<span class=" -Color -Color-Bold">profile</span>: {&#39;profileSchema&#39;: &#39;eo_profile_schema.json&#39;, &#39;name&#39;: &#39;Earth Observation&#39;, &#39;mission&#39;: &#39;CAMS&#39;, &#39;sensor&#39;: &#39;CAMS&#39;, &#39;processingLevel&#39;: &#39;forecast&#39;, &#39;instrument&#39;: &#39;&#39;, &#39;platform&#39;: &#39;&#39;}
<span class=" -Color -Color-Bold">resolutionUnit</span>: degree
<span class=" -Color -Color-Bold">temporalResolution</span>: Daily
<span class=" -Color -Color-Bold">unit</span>: 
<span class=" -Color -Color-Bold">unitDescription</span>: 
<span class=" -Color -Color-Bold">updateDate</span>: 2022-05-29T12:00:52Z
<span class=" -Color -Color-Bold">geometry</span>: {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}
<span class=" -Color -Color-Bold">resolutions</span>: [0.1]
<span class=" -Color -Color-Bold">anyText</span>: 4326,ESA,Daily,ESA
<span class=" -Color -Color-Bold">applications</span>: [&#39;Atmosphere&#39;]
<span class=" -Color -Color-Bold">datasetManager</span>: govoni@meeo.it
<span class=" -Color -Color-Bold">datasetManagerOrganisation</span>: meeo
<span class=" -Color -Color-Bold">description</span>: CAMS SURFACE PARTICULATE METTER D&lt;2.5
<span class=" -Color -Color-Bold">title</span>: CAMS European air quality forecasts: PM25
<span class=" -Color -Color-Bold">noDataValue</span>: 0
<span class=" -Color -Color-Bold">timeReferenceSystem</span>: UTC
<span class=" -Color -Color-Bold">units</span>: µg m-3
<span class=" -Color -Color-Bold">unitsDescription</span>: PM2.5
<span class=" -Color -Color-Bold">services</span>: [&#39;MWCS&#39;, &#39;ADAM&#39;, &#39;AdamApi&#39;]
<span class=" -Color -Color-Bold">technicalManager</span>: govoni@meeo.it
<span class=" -Color -Color-Bold">filtersEnabled</span>: {&#39;type&#39;: &#39;object&#39;, &#39;title&#39;: &#39;Dataset filters&#39;, &#39;properties&#39;: {&#39;startDate&#39;: {&#39;title&#39;: &#39;Start Date&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date&#39;, &#39;text_rule&#39;: &#39;false&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;false&#39;, &#39;pattern&#39;: &#39;^d{4}-[01]d-[0-3]d(T[0-2]d:[0-9]d:[0-9]dZ)?$&#39;}, &#39;endDate&#39;: {&#39;title&#39;: &#39;End Date&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;text_rule&#39;: &#39;false&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;false&#39;, &#39;pattern&#39;: &#39;^d{4}-[01]d-[0-3]d(T[0-2]d:[0-9]d:[0-9]dZ)?$&#39;}, &#39;productId&#39;: {&#39;title&#39;: &#39;Product Identifier&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;string&#39;, &#39;text_rule&#39;: &#39;true&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;true&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;locked&#39;: &#39;true&#39;}}}
<span class=" -Color -Color-Bold">previews</span>: 
<span class=" -Color -Color-Bold">startDate</span>: 2018-07-12T00:00:00Z
<span class=" -Color -Color-Bold">endDate</span>: 2022-05-28T23:00:00Z
<span class=" -Color -Color-Bold">accounting</span>: {&#39;unit&#39;: 0.0032}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="surface-ozone-o3">
<h3>Surface Ozone (O3)<a class="headerlink" href="#surface-ozone-o3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasetID_O3</span> <span class="o">=</span> <span class="s1">&#39;69625:EU_CAMS_SURFACE_O3_G&#39;</span>
<span class="n">metadata_O3</span> <span class="o">=</span> <span class="n">get_metadata</span><span class="p">(</span><span class="n">datasetID_O3</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">Metadata of 69625:EU_CAMS_SURFACE_O3_G:</span>

<span class=" -Color -Color-Bold">datasetId</span>: 69625:EU_CAMS_SURFACE_O3_G
<span class=" -Color -Color-Bold">creationDate</span>: 2021-07-12T02:00:00Z
<span class=" -Color -Color-Bold">dataType</span>: Float32
<span class=" -Color -Color-Bold">epsg</span>: 4326
<span class=" -Color -Color-Bold">keywords</span>: []
<span class=" -Color -Color-Bold">license</span>: {&#39;documentationUrl&#39;: &#39;&#39;, &#39;dataProviderName&#39;: &#39;ADS&#39;, &#39;dataProviderUrl&#39;: &#39;&#39;, &#39;licenseId&#39;: &#39;&#39;, &#39;dataPolicy&#39;: &#39;&#39;, &#39;doi&#39;: &#39;&#39;, &#39;credits&#39;: &#39;&#39;}
<span class=" -Color -Color-Bold">maxValue</span>: [2.2007016298175586e-07]
<span class=" -Color -Color-Bold">minValue</span>: [0.0]
<span class=" -Color -Color-Bold">numberOfRecords</span>: 34329
<span class=" -Color -Color-Bold">profile</span>: {&#39;profileSchema&#39;: &#39;eo_profile_schema.json&#39;, &#39;name&#39;: &#39;Earth Observation&#39;, &#39;mission&#39;: &#39;CAMS&#39;, &#39;sensor&#39;: &#39;CAMS&#39;, &#39;processingLevel&#39;: &#39;forecast&#39;, &#39;instrument&#39;: &#39;&#39;, &#39;platform&#39;: &#39;&#39;}
<span class=" -Color -Color-Bold">resolutionUnit</span>: degree
<span class=" -Color -Color-Bold">temporalResolution</span>: Hourly
<span class=" -Color -Color-Bold">unit</span>: 
<span class=" -Color -Color-Bold">unitDescription</span>: 
<span class=" -Color -Color-Bold">updateDate</span>: 2022-05-29T12:05:10Z
<span class=" -Color -Color-Bold">geometry</span>: {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}
<span class=" -Color -Color-Bold">resolutions</span>: [0.1]
<span class=" -Color -Color-Bold">anyText</span>: 4326,ESA,Daily,ESA
<span class=" -Color -Color-Bold">applications</span>: [&#39;Atmosphere&#39;]
<span class=" -Color -Color-Bold">datasetManager</span>: govoni@meeo.it
<span class=" -Color -Color-Bold">datasetManagerOrganisation</span>: meeo
<span class=" -Color -Color-Bold">description</span>: CAMS OZONE
<span class=" -Color -Color-Bold">title</span>: CAMS European air quality forecasts: O3
<span class=" -Color -Color-Bold">noDataValue</span>: 0
<span class=" -Color -Color-Bold">timeReferenceSystem</span>: UTC
<span class=" -Color -Color-Bold">units</span>: µg m-3
<span class=" -Color -Color-Bold">unitsDescription</span>: ozone
<span class=" -Color -Color-Bold">services</span>: [&#39;MWCS&#39;, &#39;ADAM&#39;, &#39;AdamApi&#39;]
<span class=" -Color -Color-Bold">technicalManager</span>: govoni@meeo.it
<span class=" -Color -Color-Bold">filtersEnabled</span>: {&#39;type&#39;: &#39;object&#39;, &#39;title&#39;: &#39;Dataset filters&#39;, &#39;properties&#39;: {&#39;startDate&#39;: {&#39;title&#39;: &#39;Start Date&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date&#39;, &#39;text_rule&#39;: &#39;false&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;false&#39;, &#39;pattern&#39;: &#39;^d{4}-[01]d-[0-3]d(T[0-2]d:[0-9]d:[0-9]dZ)?$&#39;}, &#39;endDate&#39;: {&#39;title&#39;: &#39;End Date&#39;, &#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date&#39;, &#39;ops_only&#39;: &#39;false&#39;, &#39;text_rule&#39;: &#39;false&#39;, &#39;math_rule&#39;: &#39;false&#39;, &#39;order_rule&#39;: &#39;false&#39;, &#39;pattern&#39;: &#39;^d{4}-[01]d-[0-3]d(T[0-2]d:[0-9]d:[0-9]dZ)?$&#39;}}}
<span class=" -Color -Color-Bold">previews</span>: 
<span class=" -Color -Color-Bold">startDate</span>: 2018-07-12T00:00:00Z
<span class=" -Color -Color-Bold">endDate</span>: 2022-05-28T23:00:00Z
<span class=" -Color -Color-Bold">accounting</span>: {&#39;unit&#39;: 0.0032}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-6-products-discovery-a-products-discovery">
<h2><a id=6.Products_Discovery></a> Products Discovery<a class="headerlink" href="#a-id-6-products-discovery-a-products-discovery" title="Permalink to this headline">¶</a></h2>
<p>The products discovery operation related to a specific dataset is implemented in the Adam API with the <font color='blue'> <strong>getProducts()</strong> </font> function. A combined <strong>spatial and temporal search</strong> can be requested by specifying the <font color='red'> <strong>datasetId</strong> </font> for the selected dataset,the <font color='red'> <strong>geometry</strong> </font> argument that specifies the <u>Area Of Interest</u> and a temporal range, defined by <code class="docutils literal notranslate"><span class="pre">startDate</span></code> and <code class="docutils literal notranslate"><span class="pre">endDate</span></code> . The geometry must <strong><u>always</u></strong> be defined by a <font color='red'> <strong>GeoJson object</strong> </font> that describes the polygon in the <strong><u>counterclockwise winding order</strong></u>. The optional arguments <code class="docutils literal notranslate"><span class="pre">startIndex</span></code> and <code class="docutils literal notranslate"><span class="pre">maxRecords</span></code> can set the list of the results returned as an output. The results of the search are displayed with their metadata and they are sorted starting from the most recent product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">adamapi</span> <span class="kn">import</span> <span class="n">Search</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_products</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetID</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">search</span> <span class="o">=</span> <span class="n">Search</span><span class="p">(</span> <span class="n">a</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">geom</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">getProducts</span><span class="p">(</span>
            <span class="n">datasetID</span><span class="p">,</span> 
            <span class="n">geometry</span><span class="o">=</span> <span class="n">geom_1</span><span class="p">,</span>
            <span class="n">startDate</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span>
            <span class="n">endDate</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">getProducts</span><span class="p">(</span>
            <span class="n">datasetID</span><span class="p">,</span> 
            <span class="n">startDate</span> <span class="o">=</span> <span class="n">start_date</span><span class="p">,</span>
            <span class="n">endDate</span> <span class="o">=</span> <span class="n">end_date</span>
        <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="c1"># Printing the results</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[1m&#39;</span> <span class="o">+</span> <span class="s1">&#39;List of available products:&#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0m&#39;</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1;31;1m&quot;</span> <span class="o">+</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0m&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">+</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="check-availability-of-no2-pm2-5-and-o3-for-march-2019-to-june-2021-over-the-whole-available-area">
<h3>Check availability of NO2, PM2.5 and O3 for March 2019 to June 2021 over the whole available area<a class="headerlink" href="#check-availability-of-no2-pm2-5-and-o3-for-march-2019-to-june-2021-over-the-whole-available-area" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2019-03-01&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;2021-06-30&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="discover-no2-products">
<h4>Discover NO2 products<a class="headerlink" href="#discover-no2-products" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find_products</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetID_NO2</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">List of available products:</span>

<span class=" -Color -Color-Bold -Color-Bold-Red">#1</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e153b&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T23:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630230000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e153b&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e153b&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#2</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e1540&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T22:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630220000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1540&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1540&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#3</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e153d&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T21:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630210000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e153d&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e153d&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#4</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e1538&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T20:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630200000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1538&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1538&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#5</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e152b&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T19:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630190000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e152b&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e152b&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#6</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e1532&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T18:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630180000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1532&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1532&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#7</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e152d&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T17:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630170000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e152d&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e152d&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#8</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e1527&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T16:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630160000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1527&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e1527&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#9</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e151e&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T15:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630150000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e151e&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e151e&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#10</span>

_id: {&#39;$oid&#39;: &#39;60fb13a5320b76365f6e151b&#39;}
datasetId: EU_CAMS_SURFACE_NO2_G
productDate: 2021-06-30T14:00:00Z
productId: EU_CAMS_SURFACE_NO2_G_20210630140000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T19:08:21Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e151b&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_NO2_G&amp;_id=60fb13a5320b76365f6e151b&#39;}
------------------------------------
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="discover-pm2-5-products">
<h4>Discover PM2.5 products<a class="headerlink" href="#discover-pm2-5-products" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find_products</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetID_PM2_5</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">List of available products:</span>

<span class=" -Color -Color-Bold -Color-Bold-Red">#1</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fadc&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T23:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630230000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fadc&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fadc&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#2</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fadf&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T22:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630220000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fadf&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fadf&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#3</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fad7&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T21:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630210000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fad7&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fad7&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#4</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fad5&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T20:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630200000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fad5&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fad5&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#5</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61faca&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T19:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630190000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61faca&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61faca&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#6</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61face&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T18:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630180000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61face&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61face&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#7</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fac2&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T17:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630170000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fac2&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fac2&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#8</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fac5&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T16:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630160000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fac5&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fac5&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#9</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fabd&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T15:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630150000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fabd&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fabd&#39;}
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#10</span>

_id: {&#39;$oid&#39;: &#39;60fa9c32320b76365f61fab7&#39;}
datasetId: EU_CAMS_SURFACE_PM25_G
productDate: 2021-06-30T14:00:00Z
productId: EU_CAMS_SURFACE_PM25_G_20210630140000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-23T10:38:42Z
status: Online
productLink: {&#39;tiff&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/tiff&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fab7&#39;, &#39;png&#39;: &#39;https://reliance-das.adamplatform.eu/wcs?service=WCS&amp;version=2.0.0&amp;request=GetCoverage&amp;format=image/png&amp;coverageId=EU_CAMS_SURFACE_PM25_G&amp;_id=60fa9c32320b76365f61fab7&#39;}
------------------------------------
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="discover-o3-products">
<h4>Discover O3 products<a class="headerlink" href="#discover-o3-products" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find_products</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetID_O3</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">List of available products:</span>

<span class=" -Color -Color-Bold -Color-Bold-Red">#1</span>

_id: {&#39;$oid&#39;: &#39;60fb650e320b76365f794fad&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T23:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630230000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#2</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794fa5&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T22:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630220000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#3</span>

_id: {&#39;$oid&#39;: &#39;60fb650e320b76365f794fa8&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T21:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630210000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#4</span>

_id: {&#39;$oid&#39;: &#39;60fb650e320b76365f794fab&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T20:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630200000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#5</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794f9d&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T19:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630190000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#6</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794f94&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T18:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630180000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#7</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794f9b&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T17:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630170000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#8</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794f97&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T16:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630160000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#9</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794f8d&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T15:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630150000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
<span class=" -Color -Color-Bold -Color-Bold-Red">#10</span>

_id: {&#39;$oid&#39;: &#39;60fb650d320b76365f794f86&#39;}
datasetId: EU_CAMS_SURFACE_O3_G
productDate: 2021-06-30T14:00:00Z
productId: EU_CAMS_SURFACE_O3_G_20210630140000.tif
geometry: {&#39;geometries&#39;: [{&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-25.000012, 29.999997], [44.999988, 29.999997], [44.999988, 71.999997], [-25.000012, 71.999997], [-25.000012, 29.999997]]]}], &#39;type&#39;: &#39;GeometryCollection&#39;}
insertDate: 2021-07-24T00:55:41Z
status: Online
------------------------------------
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-7-data-access-a-data-access">
<h2><a id=7.Data_Access></a> Data Access<a class="headerlink" href="#a-id-7-data-access-a-data-access" title="Permalink to this headline">¶</a></h2>
<p>After the data discovery operation that retrieves the availability of products in the catalogue, it is possible to access the data with the <font color='blue'> <strong>getData</strong> </font> function. Each product in the output list intersects the selected geometry and the following example shows how to access a specific product from the list of results obtained in the previous step. While the <font color='red'> <strong>datasetId</strong> </font> is always a mandatory parameter, for each data access request the <font color='blue'> <strong>getData</strong> </font> function needs only one of the following arguments: <font color='red'> <strong>geometry</strong> </font> or <font color='red'> <strong>productId</strong> </font>, that is the value of the <font color='blue'> <strong>_id</strong> </font> field in each product metadata. In the case of a <u><strong>spatial and temporal search</strong></u> the geometry must be provided to the function, together with the time range of interest.
The output of the <font color='blue'> <strong>getData</strong> </font> function is <u>always</u> a <font color='red'> <strong>.zip</strong> </font> file containing the data retrieved with the data access request, providing the spatial <strong>subset</strong> of the product. The zip file will contain a geotiff file for each of the spatial subsets extracted in the selected time range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">adamapi</span> <span class="kn">import</span> <span class="n">GetData</span>
<span class="kn">from</span> <span class="nn">geojson_rewind</span> <span class="kn">import</span> <span class="n">rewind</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="define-a-function-to-select-a-time-range-geometry-and-get-data">
<h3>Define a function to select a time range, geometry and get data<a class="headerlink" href="#define-a-function-to-select-a-time-range-geometry-and-get-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geom_cam</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;{</span>
<span class="s2">  &quot;type&quot;: &quot;FeatureCollection&quot;,</span>
<span class="s2">  &quot;features&quot;: [</span>
<span class="s2">    {</span>
<span class="s2">      &quot;type&quot;: &quot;Feature&quot;,</span>
<span class="s2">      &quot;properties&quot;: </span><span class="si">{}</span><span class="s2">,</span>
<span class="s2">      &quot;geometry&quot;: {</span>
<span class="s2">        &quot;type&quot;: &quot;Polygon&quot;,</span>
<span class="s2">        &quot;coordinates&quot;: [</span>
<span class="s2">          [</span>
<span class="s2">            [</span>
<span class="s2">              -25.0,</span>
<span class="s2">              30.0</span>
<span class="s2">            ],</span>
<span class="s2">            [</span>
<span class="s2">              45.0,</span>
<span class="s2">              30.0</span>
<span class="s2">            ],</span>
<span class="s2">            [</span>
<span class="s2">              45.0,</span>
<span class="s2">              70.0</span>
<span class="s2">            ],</span>
<span class="s2">            [</span>
<span class="s2">              -25.0,</span>
<span class="s2">              70.0</span>
<span class="s2">            ],</span>
<span class="s2">            [</span>
<span class="s2">              -25.0,</span>
<span class="s2">              30.0</span>
<span class="s2">            ]</span>
<span class="s2">          ]</span>
<span class="s2">        ]</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">  ]</span>
<span class="s2">}&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reformat-geometry-for-adam-api">
<h4>Reformat geometry for ADAM API<a class="headerlink" href="#reformat-geometry-for-adam-api" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">rewind</span><span class="p">(</span><span class="n">geom_cam</span><span class="p">)</span>
<span class="n">geom_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="n">geom_cam_adam</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">geom_dict</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getZipData</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">dataset_info</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;outputFname&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;outputFname&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
        <span class="n">data</span><span class="o">=</span><span class="n">GetData</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span>
            <span class="n">datasetId</span> <span class="o">=</span> <span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;datasetID&#39;</span><span class="p">],</span>
            <span class="n">startDate</span> <span class="o">=</span> <span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;startDate&#39;</span><span class="p">],</span>
            <span class="n">endDate</span> <span class="o">=</span> <span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;endDate&#39;</span><span class="p">],</span>
            <span class="n">geometry</span> <span class="o">=</span> <span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span>
            <span class="n">outputFname</span> <span class="o">=</span> <span class="n">dataset_info</span><span class="p">[</span><span class="s1">&#39;outputFname&#39;</span><span class="p">])</span>
        
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="get-no2-products-for-march-june-in-2019-2020-and-2021">
<h3>Get NO2 Products for March-June in 2019, 2020 and 2021<a class="headerlink" href="#get-no2-products-for-march-june-in-2019-2020-and-2021" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">zipfilename_NO2</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]:</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;-03-01&#39;</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;-06-30&#39;</span>
    <span class="n">zipfilename_NO2</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;NO2_EUROPE_ADAMAPI_&#39;</span> <span class="o">+</span> <span class="n">sd</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ed</span> <span class="o">+</span> <span class="s1">&#39;.zip&#39;</span>
    
    <span class="n">datasetInfo_NO2</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;datasetID&#39;</span>   <span class="p">:</span> <span class="n">datasetID_NO2</span><span class="p">,</span>
        <span class="s1">&#39;startDate&#39;</span>   <span class="p">:</span> <span class="n">sd</span><span class="p">,</span>
        <span class="s1">&#39;endDate&#39;</span>     <span class="p">:</span> <span class="n">ed</span><span class="p">,</span>
        <span class="s1">&#39;geometry&#39;</span>    <span class="p">:</span> <span class="n">geom_cam_adam</span><span class="p">,</span> 
        <span class="s1">&#39;outputFname&#39;</span> <span class="p">:</span> <span class="n">zipfilename_NO2</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
        <span class="p">}</span>
    
    <span class="n">getZipData</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetInfo_NO2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 5.78 ms, sys: 352 µs, total: 6.14 ms
Wall time: 38.7 ms
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-pm2-5-products-for-march-june-in-2019-2020-and-2021">
<h3>Get PM2.5 Products for March-June in 2019, 2020 and 2021<a class="headerlink" href="#get-pm2-5-products-for-march-june-in-2019-2020-and-2021" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">zipfilename_PM2_5</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]:</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;-03-01&#39;</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;-06-30&#39;</span>
    <span class="n">zipfilename_PM2_5</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;PM2_5_EUROPE_ADAMAPI_&#39;</span> <span class="o">+</span> <span class="n">sd</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ed</span> <span class="o">+</span> <span class="s1">&#39;.zip&#39;</span>
    
    <span class="n">datasetInfo_PM2_5</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;datasetID&#39;</span>   <span class="p">:</span> <span class="n">datasetID_PM2_5</span><span class="p">,</span>
        <span class="s1">&#39;startDate&#39;</span>   <span class="p">:</span> <span class="n">sd</span><span class="p">,</span>
        <span class="s1">&#39;endDate&#39;</span>     <span class="p">:</span> <span class="n">ed</span><span class="p">,</span>
        <span class="s1">&#39;geometry&#39;</span>    <span class="p">:</span> <span class="n">geom_cam_adam</span><span class="p">,</span> 
        <span class="s1">&#39;outputFname&#39;</span> <span class="p">:</span> <span class="n">zipfilename_PM2_5</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
        <span class="p">}</span>
    
    <span class="n">getZipData</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetInfo_PM2_5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.49 ms, sys: 4.04 ms, total: 6.53 ms
Wall time: 33.7 ms
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-o3-products-for-march-june-in-2019-2020-and-2021">
<h3>Get O3 Products for March-June in 2019, 2020 and 2021<a class="headerlink" href="#get-o3-products-for-march-june-in-2019-2020-and-2021" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">zipfilename_O3</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]:</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;-03-01&#39;</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;-06-30&#39;</span>
    <span class="n">zipfilename_O3</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;O3_EUROPE_ADAMAPI_&#39;</span> <span class="o">+</span> <span class="n">sd</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ed</span> <span class="o">+</span> <span class="s1">&#39;.zip&#39;</span>
    
    <span class="n">datasetInfo_O3</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;datasetID&#39;</span>   <span class="p">:</span> <span class="n">datasetID_O3</span><span class="p">,</span>
        <span class="s1">&#39;startDate&#39;</span>   <span class="p">:</span> <span class="n">sd</span><span class="p">,</span>
        <span class="s1">&#39;endDate&#39;</span>     <span class="p">:</span> <span class="n">ed</span><span class="p">,</span>
        <span class="s1">&#39;geometry&#39;</span>    <span class="p">:</span> <span class="n">geom_cam_adam</span><span class="p">,</span> 
        <span class="s1">&#39;outputFname&#39;</span> <span class="p">:</span> <span class="n">zipfilename_O3</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="n">getZipData</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">datasetInfo_O3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3.73 ms, sys: 2.47 ms, total: 6.2 ms
Wall time: 35.7 ms
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-8-data-analysis-visualization-a-data-analysis-and-visualization">
<h2><a id=8.Data_Analysis_Visualization></a> Data Analysis and Visualization<a class="headerlink" href="#a-id-8-data-analysis-visualization-a-data-analysis-and-visualization" title="Permalink to this headline">¶</a></h2>
<p>The data retrieved via the Adam API are now available as a zip file that must be unzipped to directly handle the data in a geotiff format. Then with the Python packages provided in the Jupyter environment it is possible to process and visualized the requested product.</p>
<div class="section" id="unzip-no2-pm2-5-and-o3-data">
<h3>Unzip NO2, PM2.5 and O3 data<a class="headerlink" href="#unzip-no2-pm2-5-and-o3-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zipfile</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">unzipData</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">out_prefix</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_prefix</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_prefix</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_prefix</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]:</span>
    <span class="n">unzipData</span><span class="p">(</span><span class="n">zipfilename_NO2</span><span class="p">[</span><span class="n">year</span><span class="p">],</span> <span class="n">INPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jovyan/datahub/Reliance/Climate/input/NO2_EUROPE_ADAMAPI_2019-03-01_2019-06-30
/home/jovyan/datahub/Reliance/Climate/input/NO2_EUROPE_ADAMAPI_2020-03-01_2020-06-30
/home/jovyan/datahub/Reliance/Climate/input/NO2_EUROPE_ADAMAPI_2021-03-01_2021-06-30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]:</span>
    <span class="n">unzipData</span><span class="p">(</span><span class="n">zipfilename_PM2_5</span><span class="p">[</span><span class="n">year</span><span class="p">],</span> <span class="n">INPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jovyan/datahub/Reliance/Climate/input/PM2_5_EUROPE_ADAMAPI_2019-03-01_2019-06-30
/home/jovyan/datahub/Reliance/Climate/input/PM2_5_EUROPE_ADAMAPI_2020-03-01_2020-06-30
/home/jovyan/datahub/Reliance/Climate/input/PM2_5_EUROPE_ADAMAPI_2021-03-01_2021-06-30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]:</span>
    <span class="n">unzipData</span><span class="p">(</span><span class="n">zipfilename_O3</span><span class="p">[</span><span class="n">year</span><span class="p">],</span> <span class="n">INPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jovyan/datahub/Reliance/Climate/input/O3_EUROPE_ADAMAPI_2019-03-01_2019-06-30
/home/jovyan/datahub/Reliance/Climate/input/O3_EUROPE_ADAMAPI_2020-03-01_2020-06-30
/home/jovyan/datahub/Reliance/Climate/input/O3_EUROPE_ADAMAPI_2021-03-01_2021-06-30
</pre></div>
</div>
</div>
</div>
<div class="section" id="read-no2-pm2-5-and-o3-data-as-xarray">
<h4>Read NO2, PM2.5 and O3 data as Xarray<a class="headerlink" href="#read-no2-pm2-5-and-o3-data-as-xarray" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
</div>
</div>
<p>We now read these files using <code class="docutils literal notranslate"><span class="pre">xarray</span></code>. First, we make a list of all the geotiff files in a given folder. To ensure each raster is labelled correctly with its time, we can use a helper function <code class="docutils literal notranslate"><span class="pre">paths_to_datetimeindex()</span></code> to extract time information from the file paths we obtained above. We then load and concatenate each dataset along the time dimension using <code class="docutils literal notranslate"><span class="pre">xarray.open_rasterio()</span></code>, convert the resulting <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> to a <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>, and give the variable a more useful name.</p>
<p>Our data comes with different grids depending on the time period. For instance, the grid and geographical area for Copernicus Air Quality Analyses before June 12, 2019 is different from data after that date. Therefore, we need to regrid all data before June 12, 2019 to the “new” grid (any time after that date). We use <code class="docutils literal notranslate"><span class="pre">xesmf</span></code> for regridding.</p>
</div>
<div class="section" id="utility-functions-for-regridding-and-reading-data-into-xarrays">
<h4>Utility functions for regridding and reading data into Xarrays<a class="headerlink" href="#utility-functions-for-regridding-and-reading-data-into-xarrays" title="Permalink to this headline">¶</a></h4>
<div class="section" id="select-the-resulting-output-grid">
<h5>Select the resulting output grid<a class="headerlink" href="#select-the-resulting-output-grid" title="Permalink to this headline">¶</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">parse_coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Convert our xarray.DataArray into a xarray.Dataset</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;band&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">factor</span>
    <span class="c1"># Rename the dimensions to make it CF-convention compliant</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">rename_dims</span><span class="p">({</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
    <span class="c1"># Rename the variable to a more useful name</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="n">variable</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span> <span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">],</span> <span class="s1">&#39;long_name&#39;</span> <span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]}</span>
    <span class="k">return</span> <span class="n">tmp</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pick-a-recent-date-for-getting-the-output-grid">
<h5>pick a recent date for getting the output grid<a class="headerlink" href="#pick-a-recent-date-for-getting-the-output-grid" title="Permalink to this headline">¶</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_grid</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/NO2_EUROPE_ADAMAPI_2021-03-01_2021-06-30/eu_cams_surface_no2_g_2021-06-30t000000.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="n">metadata_NO2</span><span class="p">)</span>
<span class="n">output_grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 400, longitude: 700)
Coordinates:
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
Data variables:
    NO2        (latitude, longitude) float32 3.474e-11 4.016e-11 ... 1.052e-10
Attributes:
    transform:      (0.1, 0.0, -25.000012009299, 0.0, -0.1, 69.99999699761337)
    crs:            +init=epsg:4326
    res:            (0.1, 0.1)
    is_tiled:       0
    nodatavals:     (0.0,)
    scales:         (1.0,)
    offsets:        (0.0,)
    AREA_OR_POINT:  Area</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5030d771-d9fc-4061-9741-3298a72926d4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5030d771-d9fc-4061-9741-3298a72926d4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-3b540d95-82e7-46f2-aa27-e09d2046a830' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3b540d95-82e7-46f2-aa27-e09d2046a830' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-b32f5eed-a63a-47ed-b34b-2abe42ee2fc6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b32f5eed-a63a-47ed-b34b-2abe42ee2fc6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b3c3c8d-74c4-4225-8d2c-871b976e565e' class='xr-var-data-in' type='checkbox'><label for='data-8b3c3c8d-74c4-4225-8d2c-871b976e565e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-67e35cfa-bf44-4605-9793-8cf3a7702957' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67e35cfa-bf44-4605-9793-8cf3a7702957' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2bf48db6-3965-4b6b-b9d9-a85ed6a4090a' class='xr-var-data-in' type='checkbox'><label for='data-2bf48db6-3965-4b6b-b9d9-a85ed6a4090a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3d6367a0-693b-4e94-a891-53d1e5554e38' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3d6367a0-693b-4e94-a891-53d1e5554e38' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>NO2</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>3.474e-11 4.016e-11 ... 1.052e-10</div><input id='attrs-e894e2fa-8985-45f5-be30-e27b2eef85ec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e894e2fa-8985-45f5-be30-e27b2eef85ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b27248fd-1cb5-4f09-80ad-e5cd7c0bf1f8' class='xr-var-data-in' type='checkbox'><label for='data-b27248fd-1cb5-4f09-80ad-e5cd7c0bf1f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS NITROGEN DIOXIDE</dd></dl></div><div class='xr-var-data'><pre>array([[3.47370292e-11, 4.01584703e-11, 4.03218951e-11, ...,
        7.53303392e-11, 7.41792530e-11, 7.11168208e-11],
       [3.65560221e-11, 4.03218951e-11, 4.03218951e-11, ...,
        8.10288850e-11, 8.01478189e-11, 7.71990666e-11],
       [3.83750080e-11, 4.03218951e-11, 4.03218951e-11, ...,
        9.19712501e-11, 9.10333336e-11, 8.81201015e-11],
       ...,
       [5.15413649e-11, 5.14916269e-11, 5.19534797e-11, ...,
        8.67984989e-11, 8.36436823e-11, 1.08100563e-10],
       [4.95376309e-11, 5.22092751e-11, 5.30548210e-11, ...,
        8.50221352e-11, 8.15262718e-11, 1.07773714e-10],
       [4.89692002e-11, 4.83581335e-11, 4.92889445e-11, ...,
        9.65187166e-11, 8.62087485e-11, 1.05180233e-10]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-df5208b0-89c1-4a3b-a48c-eeeefe19f7d1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-df5208b0-89c1-4a3b-a48c-eeeefe19f7d1' class='xr-section-summary' >Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>(0.1, 0.0, -25.000012009299, 0.0, -0.1, 69.99999699761337)</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>(0.1, 0.1)</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>(0.0,)</dd><dt><span>scales :</span></dt><dd>(1.0,)</dd><dt><span>offsets :</span></dt><dd>(0.0,)</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="function-to-get-the-time-from-the-filename">
<h5>Function to get the time from the filename<a class="headerlink" href="#function-to-get-the-time-from-the-filename" title="Permalink to this headline">¶</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">paths_to_datetimeindex</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
    <span class="k">return</span>  <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">t</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="function-to-read-and-regrid-data">
<h5>Function to read and regrid data<a class="headerlink" href="#function-to-read-and-regrid-data" title="Permalink to this headline">¶</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="n">dirtif</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">grid_out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">geotiff_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">dirtif</span><span class="p">)</span>
    <span class="c1"># Create variable used for time axis</span>
    <span class="n">time_var</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">paths_to_datetimeindex</span><span class="p">(</span><span class="n">geotiff_list</span><span class="p">))</span>
    <span class="c1"># Load in and concatenate all individual GeoTIFFs</span>
    <span class="n">xarray_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">grid_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nlats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">nlons</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">geotiff_list</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="n">factor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">grid_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;regridding &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">regridder</span> <span class="o">=</span> <span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">grid_out</span><span class="p">,</span> <span class="s1">&#39;conservative&#39;</span><span class="p">)</span>
            <span class="n">tmp_regrid</span> <span class="o">=</span> <span class="n">regridder</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">xarray_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_regrid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xarray_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="c1">#print(xarray_list[0:2])</span>
    <span class="n">geotiffs_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">xarray_list</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">time_var</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">geotiffs_da</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="function-to-plot-one-single-date">
<h4>Function to plot one single date<a class="headerlink" href="#function-to-plot-one-single-date" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cmcrameri.cm</span> <span class="k">as</span> <span class="nn">cmc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_one_date</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_ds</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">prefix_path</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="c1"># Define the projection</span>
    
    <span class="c1"># We&#39;re using cartopy and are plotting in the chosen projection </span>
    <span class="c1"># (see documentation on cartopy)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj_plot</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

    <span class="c1"># We need to project our data to the new Mercator projection and for this we use `transform`.</span>
    <span class="c1"># we set the original data projection in transform (here PlateCarree)</span>
    <span class="c1"># we only plot values greather than 0</span>
    <span class="nb">map</span> <span class="o">=</span> <span class="n">geotiff_ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geotiff_ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> 
                                                                  <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                                                                  <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                                  <span class="n">cmap</span><span class="o">=</span><span class="n">lcmap</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="c1"># Title for plot</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plot_file</span> <span class="o">=</span> <span class="n">prefix_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span> <span class="o">+</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">plot_file</span><span class="p">,</span> <span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>  
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="function-to-plot-several-years">
<h4>Function to plot several years<a class="headerlink" href="#function-to-plot-several-years" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_dm</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">prefix_path</span><span class="p">):</span>
    <span class="c1"># generate figure</span>
    <span class="c1"># Only plot values greater than 0</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">geotiff_dm</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geotiff_dm</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                                                                <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">proj_plot</span><span class="p">},</span>
                                                                <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                                <span class="n">col</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                <span class="n">cmap</span><span class="o">=</span><span class="n">lcmap</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># We have to set the map&#39;s options on all four axes</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span>  <span class="n">geotiff_dm</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">plot_file</span> <span class="o">=</span> <span class="n">prefix_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span> <span class="o">+</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">plot_file</span><span class="p">,</span> <span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>      
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-no2">
<h4>Read NO2<a class="headerlink" href="#read-no2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NO2_filename</span> <span class="o">=</span> <span class="n">OUTPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s2">&quot;NO2_EUROPE_ADAMAPI&quot;</span> <span class="o">+</span> <span class="n">start_date</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">end_date</span> <span class="o">+</span> <span class="s1">&#39;.nc&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">NO2_filename</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
    <span class="kn">import</span> <span class="nn">xesmf</span> <span class="k">as</span> <span class="nn">xe</span>
    <span class="n">geotiff_NO2_2019</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/NO2_EUROPE_ADAMAPI_2019*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="n">metadata_NO2</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.e9</span><span class="p">,</span> <span class="n">grid_out</span><span class="o">=</span><span class="n">output_grid</span><span class="p">)</span>
    <span class="n">geotiff_NO2_2020</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/NO2_EUROPE_ADAMAPI_2020*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="n">metadata_NO2</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.e9</span><span class="p">)</span>
    <span class="n">geotiff_NO2_2021</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/NO2_EUROPE_ADAMAPI_2021*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="n">metadata_NO2</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.e9</span><span class="p">)</span>
    <span class="n">geotiff_NO2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">geotiff_NO2_2019</span><span class="p">,</span> <span class="n">geotiff_NO2_2020</span><span class="p">,</span> <span class="n">geotiff_NO2_2021</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">geotiff_NO2</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">NO2_filename</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">geotiff_NO2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">([</span><span class="n">NO2_filename</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-one-date-for-no2-here-1st-may-2020-e-g-at-the-end-of-the-lockdown">
<h4>Plot one date for NO2 (here 1st May 2020 e.g. at the end of the lockdown)<a class="headerlink" href="#plot-one-date-for-no2-here-1st-may-2020-e-g-at-the-end-of-the-lockdown" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">seldate</span> <span class="o">=</span> <span class="s1">&#39;2020-05-01&#39;</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Surface NO2 on &#39;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">seldate</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-d</span><span class="s2"> %B, %Y&quot;</span><span class="p">)</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="n">cmc</span><span class="o">.</span><span class="n">batlowW_r</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;NO2&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">20</span>                
<span class="n">plot_one_date</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_NO2</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">seldate</span><span class="p">),</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_94_0.png" src="../../_images/air_quality_lockdown_94_0.png" />
</div>
</div>
</div>
<div class="section" id="read-pm2-5">
<h4>Read PM2.5<a class="headerlink" href="#read-pm2-5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PM25_filename</span> <span class="o">=</span> <span class="n">OUTPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s2">&quot;PM2_5_EUROPE_ADAMAPI&quot;</span> <span class="o">+</span> <span class="n">start_date</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">end_date</span> <span class="o">+</span> <span class="s1">&#39;.nc&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">PM25_filename</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
    <span class="n">geotiff_PM2_5_2019</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/PM2_5_EUROPE_ADAMAPI_2019*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="n">metadata_PM2_5</span><span class="p">,</span> <span class="n">grid_out</span><span class="o">=</span><span class="n">output_grid</span><span class="p">)</span>
    <span class="n">geotiff_PM2_5_2020</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/PM2_5_EUROPE_ADAMAPI_2020*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="n">metadata_PM2_5</span><span class="p">)</span>
    <span class="n">geotiff_PM2_5_2021</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/PM2_5_EUROPE_ADAMAPI_2021*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="n">metadata_PM2_5</span><span class="p">)</span>
    <span class="n">geotiff_PM2_5</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">geotiff_PM2_5_2019</span><span class="p">,</span> <span class="n">geotiff_PM2_5_2020</span><span class="p">,</span> <span class="n">geotiff_PM2_5_2021</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">geotiff_PM2_5</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">PM25_filename</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">geotiff_PM2_5</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">([</span><span class="n">PM25_filename</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-o3">
<h4>Read O3<a class="headerlink" href="#read-o3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O3_filename</span> <span class="o">=</span> <span class="n">OUTPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s2">&quot;O3_EUROPE_ADAMAPI&quot;</span> <span class="o">+</span> <span class="n">start_date</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">end_date</span> <span class="o">+</span> <span class="s1">&#39;.nc&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">O3_filename</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
    <span class="n">geotiff_O3_2019</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/O3_EUROPE_ADAMAPI_2019*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="n">metadata_O3</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.e9</span><span class="p">,</span> <span class="n">grid_out</span><span class="o">=</span><span class="n">output_grid</span><span class="p">)</span>
    <span class="n">geotiff_O3_2020</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/O3_EUROPE_ADAMAPI_2020*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="n">metadata_O3</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.e9</span><span class="p">)</span>
    <span class="n">geotiff_O3_2021</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/O3_EUROPE_ADAMAPI_2021*/*.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="n">metadata_O3</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1.e9</span><span class="p">)</span>
    <span class="n">geotiff_O3</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">geotiff_O3_2019</span><span class="p">,</span> <span class="n">geotiff_O3_2020</span><span class="p">,</span> <span class="n">geotiff_O3_2021</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">geotiff_O3</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">O3_filename</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">geotiff_O3</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">([</span><span class="n">O3_filename</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-analysis-compute-yearly-average-and-maximum-for-the-selected-months">
<h3>Data analysis - Compute yearly average and maximum for the selected months.<a class="headerlink" href="#data-analysis-compute-yearly-average-and-maximum-for-the-selected-months" title="Permalink to this headline">¶</a></h3>
<div class="section" id="data-analysis-for-no2">
<h4>Data analysis for NO2<a class="headerlink" href="#data-analysis-for-no2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geotiff_NO2max</span> <span class="o">=</span> <span class="n">geotiff_NO2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geotiff_NO2max</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (year: 3, latitude: 400, longitude: 700)
Coordinates:
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * year       (year) int64 2019 2020 2021
Data variables:
    NO2        (year, latitude, longitude) float32 dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;
Attributes:
    transform:      [  0.1          0.         -25.00001201   0.          -0....
    crs:            +init=epsg:4326
    res:            [0.1 0.1]
    is_tiled:       0
    nodatavals:     0.0
    scales:         1.0
    offsets:        0.0
    AREA_OR_POINT:  Area
    regrid_method:  conservative</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7217b8b7-14e3-4f7a-b482-1cfd925c940f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7217b8b7-14e3-4f7a-b482-1cfd925c940f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 3</li><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-53379415-845e-4df4-9992-e89586e2780b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-53379415-845e-4df4-9992-e89586e2780b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-44b9c305-4423-4753-8e48-2003ea32bd19' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44b9c305-4423-4753-8e48-2003ea32bd19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6144d2cd-7cc1-4438-97ee-079db0756d39' class='xr-var-data-in' type='checkbox'><label for='data-6144d2cd-7cc1-4438-97ee-079db0756d39' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-80600b2e-404c-4827-ace9-50ba81262a41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-80600b2e-404c-4827-ace9-50ba81262a41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5196e376-4589-46dc-999c-c1c9471f9432' class='xr-var-data-in' type='checkbox'><label for='data-5196e376-4589-46dc-999c-c1c9471f9432' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2019 2020 2021</div><input id='attrs-4055488a-0d8e-4f67-8c0e-c4114f030772' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4055488a-0d8e-4f67-8c0e-c4114f030772' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3610d3eb-0b94-48e7-af9b-1fc633955713' class='xr-var-data-in' type='checkbox'><label for='data-3610d3eb-0b94-48e7-af9b-1fc633955713' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b11c8c20-2d33-4caa-a23b-1d57b02b5c78' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b11c8c20-2d33-4caa-a23b-1d57b02b5c78' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>NO2</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;</div><input id='attrs-a05a8710-a717-4eb4-98e2-33a822f99ed5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a05a8710-a717-4eb4-98e2-33a822f99ed5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15e46c2a-3b09-4b3c-a397-b8124d947ef5' class='xr-var-data-in' type='checkbox'><label for='data-15e46c2a-3b09-4b3c-a397-b8124d947ef5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS NITROGEN DIOXIDE</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.20 MiB </td> <td> 1.07 MiB </td></tr>
    <tr><th> Shape </th><td> (3, 400, 700) </td> <td> (1, 400, 700) </td></tr>
    <tr><th> Count </th><td> 17 Tasks </td><td> 3 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="194" height="133" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="68" x2="24" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="68" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="73" />
  <line x1="19" y1="9" x2="19" y2="78" />
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,83.52002652118297 10.0,68.57142857142857" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="83" x2="144" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,83.52002652118297 24.9485979497544,83.52002652118297" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="103.520027" font-size="1.0rem" font-weight="100" text-anchor="middle" >700</text>
  <text x="164.948598" y="49.234312" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,49.234312)">400</text>
  <text x="7.474299" y="96.045728" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,96.045728)">3</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-56e15e49-b16f-475d-98c9-619104852f80' class='xr-section-summary-in' type='checkbox'  checked><label for='section-56e15e49-b16f-475d-98c9-619104852f80' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>[  0.1          0.         -25.00001201   0.          -0.1
  69.999997  ]</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>[0.1 0.1]</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>0.0</dd><dt><span>scales :</span></dt><dd>1.0</dd><dt><span>offsets :</span></dt><dd>0.0</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>regrid_method :</span></dt><dd>conservative</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geotiff_NO2avg</span> <span class="o">=</span> <span class="n">geotiff_NO2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geotiff_NO2avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (year: 3, latitude: 400, longitude: 700)
Coordinates:
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * year       (year) int64 2019 2020 2021
Data variables:
    NO2        (year, latitude, longitude) float32 dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;
Attributes:
    transform:      [  0.1          0.         -25.00001201   0.          -0....
    crs:            +init=epsg:4326
    res:            [0.1 0.1]
    is_tiled:       0
    nodatavals:     0.0
    scales:         1.0
    offsets:        0.0
    AREA_OR_POINT:  Area
    regrid_method:  conservative</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8fe7bd71-c484-43c2-81a3-8f1e405c4265' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8fe7bd71-c484-43c2-81a3-8f1e405c4265' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 3</li><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ec4caa72-3897-48ae-b4d6-c5f7e23f12c0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ec4caa72-3897-48ae-b4d6-c5f7e23f12c0' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-d00d52ab-4d41-48d5-a1a3-b1fcede61e56' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d00d52ab-4d41-48d5-a1a3-b1fcede61e56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb5c48ab-85e0-46a9-ae48-ef022ba6fc36' class='xr-var-data-in' type='checkbox'><label for='data-eb5c48ab-85e0-46a9-ae48-ef022ba6fc36' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-debeaad9-8f81-4253-936f-247d1d3b164c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-debeaad9-8f81-4253-936f-247d1d3b164c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-224f6c57-b603-4f4b-92b0-1b15cf37f60d' class='xr-var-data-in' type='checkbox'><label for='data-224f6c57-b603-4f4b-92b0-1b15cf37f60d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2019 2020 2021</div><input id='attrs-847e9183-7329-4e69-9f7d-5ae754bfaa88' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-847e9183-7329-4e69-9f7d-5ae754bfaa88' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1c66f34-6269-4cf2-8242-8559e50be90f' class='xr-var-data-in' type='checkbox'><label for='data-f1c66f34-6269-4cf2-8242-8559e50be90f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eb49e432-a945-45fb-a6bc-edb7ccf0c301' class='xr-section-summary-in' type='checkbox'  checked><label for='section-eb49e432-a945-45fb-a6bc-edb7ccf0c301' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>NO2</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;</div><input id='attrs-97bbbf68-819c-422c-a166-88decd43cebf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-97bbbf68-819c-422c-a166-88decd43cebf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ffc62a15-8fd7-4107-ae69-cadd72ace154' class='xr-var-data-in' type='checkbox'><label for='data-ffc62a15-8fd7-4107-ae69-cadd72ace154' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS NITROGEN DIOXIDE</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.20 MiB </td> <td> 1.07 MiB </td></tr>
    <tr><th> Shape </th><td> (3, 400, 700) </td> <td> (1, 400, 700) </td></tr>
    <tr><th> Count </th><td> 17 Tasks </td><td> 3 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="194" height="133" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="68" x2="24" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="68" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="73" />
  <line x1="19" y1="9" x2="19" y2="78" />
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,83.52002652118297 10.0,68.57142857142857" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="83" x2="144" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,83.52002652118297 24.9485979497544,83.52002652118297" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="103.520027" font-size="1.0rem" font-weight="100" text-anchor="middle" >700</text>
  <text x="164.948598" y="49.234312" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,49.234312)">400</text>
  <text x="7.474299" y="96.045728" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,96.045728)">3</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-957f5bca-dec5-4482-8386-0e13d7c857e1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-957f5bca-dec5-4482-8386-0e13d7c857e1' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>[  0.1          0.         -25.00001201   0.          -0.1
  69.999997  ]</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>[0.1 0.1]</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>0.0</dd><dt><span>scales :</span></dt><dd>1.0</dd><dt><span>offsets :</span></dt><dd>0.0</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>regrid_method :</span></dt><dd>conservative</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="data-analysis-for-pm2-5">
<h4>Data analysis for PM2.5<a class="headerlink" href="#data-analysis-for-pm2-5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geotiff_PM2_5max</span> <span class="o">=</span> <span class="n">geotiff_PM2_5</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geotiff_PM2_5max</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (year: 3, latitude: 400, longitude: 700)
Coordinates:
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * year       (year) int64 2019 2020 2021
Data variables:
    PM2_5      (year, latitude, longitude) float32 dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;
Attributes:
    transform:      [  0.1          0.         -25.00001201   0.          -0....
    crs:            +init=epsg:4326
    res:            [0.1 0.1]
    is_tiled:       0
    nodatavals:     0.0
    scales:         1.0
    offsets:        0.0
    AREA_OR_POINT:  Area
    regrid_method:  conservative</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1be16ae4-4f11-4295-8d58-20fca4499782' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1be16ae4-4f11-4295-8d58-20fca4499782' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 3</li><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-75cfc3c3-c5aa-4689-8437-d923130f58f3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-75cfc3c3-c5aa-4689-8437-d923130f58f3' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-540bf279-7436-48c7-a921-dacb49636d91' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-540bf279-7436-48c7-a921-dacb49636d91' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-284bfeb6-5692-4e43-bdfb-d87e983a6f5b' class='xr-var-data-in' type='checkbox'><label for='data-284bfeb6-5692-4e43-bdfb-d87e983a6f5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-6df7a221-2f77-4042-833f-6ae3d6f66d81' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6df7a221-2f77-4042-833f-6ae3d6f66d81' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-678dd66d-ffde-4b9a-93e7-4f27b8367127' class='xr-var-data-in' type='checkbox'><label for='data-678dd66d-ffde-4b9a-93e7-4f27b8367127' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2019 2020 2021</div><input id='attrs-5f5245d6-7d8b-47c4-98df-e96dcb32ab8b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5f5245d6-7d8b-47c4-98df-e96dcb32ab8b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a8fa7266-e145-4178-b5b9-50b89fd83101' class='xr-var-data-in' type='checkbox'><label for='data-a8fa7266-e145-4178-b5b9-50b89fd83101' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-330a11fb-43ea-45e9-ad4a-56844190f192' class='xr-section-summary-in' type='checkbox'  checked><label for='section-330a11fb-43ea-45e9-ad4a-56844190f192' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>PM2_5</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;</div><input id='attrs-5aae57e9-465d-41c4-a812-f1645bcb72d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5aae57e9-465d-41c4-a812-f1645bcb72d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c17fc3a-a52a-4eaa-ae91-d595235f886c' class='xr-var-data-in' type='checkbox'><label for='data-4c17fc3a-a52a-4eaa-ae91-d595235f886c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS SURFACE PARTICULATE METTER D&lt;2.5</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.20 MiB </td> <td> 1.07 MiB </td></tr>
    <tr><th> Shape </th><td> (3, 400, 700) </td> <td> (1, 400, 700) </td></tr>
    <tr><th> Count </th><td> 17 Tasks </td><td> 3 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="194" height="133" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="68" x2="24" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="68" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="73" />
  <line x1="19" y1="9" x2="19" y2="78" />
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,83.52002652118297 10.0,68.57142857142857" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="83" x2="144" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,83.52002652118297 24.9485979497544,83.52002652118297" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="103.520027" font-size="1.0rem" font-weight="100" text-anchor="middle" >700</text>
  <text x="164.948598" y="49.234312" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,49.234312)">400</text>
  <text x="7.474299" y="96.045728" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,96.045728)">3</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-d44fc502-16ae-4db3-b08b-ff985815dfd7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d44fc502-16ae-4db3-b08b-ff985815dfd7' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>[  0.1          0.         -25.00001201   0.          -0.1
  69.999997  ]</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>[0.1 0.1]</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>0.0</dd><dt><span>scales :</span></dt><dd>1.0</dd><dt><span>offsets :</span></dt><dd>0.0</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>regrid_method :</span></dt><dd>conservative</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geotiff_PM2_5avg</span> <span class="o">=</span> <span class="n">geotiff_PM2_5</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geotiff_PM2_5avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (year: 3, latitude: 400, longitude: 700)
Coordinates:
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * year       (year) int64 2019 2020 2021
Data variables:
    PM2_5      (year, latitude, longitude) float32 dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;
Attributes:
    transform:      [  0.1          0.         -25.00001201   0.          -0....
    crs:            +init=epsg:4326
    res:            [0.1 0.1]
    is_tiled:       0
    nodatavals:     0.0
    scales:         1.0
    offsets:        0.0
    AREA_OR_POINT:  Area
    regrid_method:  conservative</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-66a2d6db-2370-49f0-9243-cec5a858f1dd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-66a2d6db-2370-49f0-9243-cec5a858f1dd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 3</li><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-69c5c119-bc80-46af-a00a-aed3f271e2cd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-69c5c119-bc80-46af-a00a-aed3f271e2cd' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-7b7bf299-5024-4a3a-89b3-13f6b6c911d6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b7bf299-5024-4a3a-89b3-13f6b6c911d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbbb2676-d321-4a3f-9744-3a7dabd784fc' class='xr-var-data-in' type='checkbox'><label for='data-cbbb2676-d321-4a3f-9744-3a7dabd784fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-52babba8-536d-49e6-bdaa-0b941f662be5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-52babba8-536d-49e6-bdaa-0b941f662be5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50e38cb9-6d8a-424a-8c94-d33ecb78c1db' class='xr-var-data-in' type='checkbox'><label for='data-50e38cb9-6d8a-424a-8c94-d33ecb78c1db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2019 2020 2021</div><input id='attrs-c76c91d8-24c7-4fcd-8244-cf1ce12d86f3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c76c91d8-24c7-4fcd-8244-cf1ce12d86f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21c86868-5a5b-4668-8ece-c490bd4129f6' class='xr-var-data-in' type='checkbox'><label for='data-21c86868-5a5b-4668-8ece-c490bd4129f6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-888eccf9-24ab-4276-8edb-ec455ef80e19' class='xr-section-summary-in' type='checkbox'  checked><label for='section-888eccf9-24ab-4276-8edb-ec455ef80e19' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>PM2_5</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;</div><input id='attrs-e96665be-0d37-4aac-8f09-7beb4a5ab2e3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e96665be-0d37-4aac-8f09-7beb4a5ab2e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a58bbef-d01a-4ded-b59f-a235e07ccfdb' class='xr-var-data-in' type='checkbox'><label for='data-7a58bbef-d01a-4ded-b59f-a235e07ccfdb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS SURFACE PARTICULATE METTER D&lt;2.5</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.20 MiB </td> <td> 1.07 MiB </td></tr>
    <tr><th> Shape </th><td> (3, 400, 700) </td> <td> (1, 400, 700) </td></tr>
    <tr><th> Count </th><td> 17 Tasks </td><td> 3 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="194" height="133" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="68" x2="24" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="68" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="73" />
  <line x1="19" y1="9" x2="19" y2="78" />
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,83.52002652118297 10.0,68.57142857142857" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="83" x2="144" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,83.52002652118297 24.9485979497544,83.52002652118297" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="103.520027" font-size="1.0rem" font-weight="100" text-anchor="middle" >700</text>
  <text x="164.948598" y="49.234312" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,49.234312)">400</text>
  <text x="7.474299" y="96.045728" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,96.045728)">3</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-030c68f0-983c-44d4-aec9-3f7d017cc989' class='xr-section-summary-in' type='checkbox'  checked><label for='section-030c68f0-983c-44d4-aec9-3f7d017cc989' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>[  0.1          0.         -25.00001201   0.          -0.1
  69.999997  ]</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>[0.1 0.1]</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>0.0</dd><dt><span>scales :</span></dt><dd>1.0</dd><dt><span>offsets :</span></dt><dd>0.0</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>regrid_method :</span></dt><dd>conservative</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="data-analysis-for-o3">
<h4>Data analysis for O3<a class="headerlink" href="#data-analysis-for-o3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geotiff_O3max</span> <span class="o">=</span> <span class="n">geotiff_O3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geotiff_O3max</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (year: 3, latitude: 400, longitude: 700)
Coordinates:
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * year       (year) int64 2019 2020 2021
Data variables:
    O3         (year, latitude, longitude) float32 dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;
Attributes:
    transform:      [  0.1          0.         -25.00001201   0.          -0....
    crs:            +init=epsg:4326
    res:            [0.1 0.1]
    is_tiled:       0
    nodatavals:     0.0
    scales:         1.0
    offsets:        0.0
    AREA_OR_POINT:  Area
    regrid_method:  conservative</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-24c06f58-1182-49d6-b0ac-958a147e9518' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-24c06f58-1182-49d6-b0ac-958a147e9518' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 3</li><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-52d347e5-3274-4a07-8cf4-f6e263111716' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52d347e5-3274-4a07-8cf4-f6e263111716' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-402a7317-10a5-4ed7-b70f-1f5f5556e640' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-402a7317-10a5-4ed7-b70f-1f5f5556e640' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-33fe6e02-9cdf-4574-9898-a939124f7a68' class='xr-var-data-in' type='checkbox'><label for='data-33fe6e02-9cdf-4574-9898-a939124f7a68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-e918818a-2030-43bf-9e9b-cdc78e8fab0a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e918818a-2030-43bf-9e9b-cdc78e8fab0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-133228cd-99df-4670-931c-7e4891e072cd' class='xr-var-data-in' type='checkbox'><label for='data-133228cd-99df-4670-931c-7e4891e072cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2019 2020 2021</div><input id='attrs-c6b035d9-67d9-4ad3-9747-bc1664d55eea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c6b035d9-67d9-4ad3-9747-bc1664d55eea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e09e28ba-514e-4795-8c31-f918c476d366' class='xr-var-data-in' type='checkbox'><label for='data-e09e28ba-514e-4795-8c31-f918c476d366' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-35fdbf39-4d41-4865-99a5-3b3af12d4368' class='xr-section-summary-in' type='checkbox'  checked><label for='section-35fdbf39-4d41-4865-99a5-3b3af12d4368' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>O3</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;</div><input id='attrs-0616abfe-08cb-4c44-8813-ac7f6907cfbb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0616abfe-08cb-4c44-8813-ac7f6907cfbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18a61de7-38ca-45b8-a6d7-269a2cff860c' class='xr-var-data-in' type='checkbox'><label for='data-18a61de7-38ca-45b8-a6d7-269a2cff860c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS OZONE</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.20 MiB </td> <td> 1.07 MiB </td></tr>
    <tr><th> Shape </th><td> (3, 400, 700) </td> <td> (1, 400, 700) </td></tr>
    <tr><th> Count </th><td> 17 Tasks </td><td> 3 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="194" height="133" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="68" x2="24" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="68" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="73" />
  <line x1="19" y1="9" x2="19" y2="78" />
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,83.52002652118297 10.0,68.57142857142857" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="83" x2="144" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,83.52002652118297 24.9485979497544,83.52002652118297" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="103.520027" font-size="1.0rem" font-weight="100" text-anchor="middle" >700</text>
  <text x="164.948598" y="49.234312" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,49.234312)">400</text>
  <text x="7.474299" y="96.045728" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,96.045728)">3</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1334afe7-e084-4853-9d34-12def9ca101e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1334afe7-e084-4853-9d34-12def9ca101e' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>[  0.1          0.         -25.00001201   0.          -0.1
  69.999997  ]</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>[0.1 0.1]</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>0.0</dd><dt><span>scales :</span></dt><dd>1.0</dd><dt><span>offsets :</span></dt><dd>0.0</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>regrid_method :</span></dt><dd>conservative</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geotiff_O3avg</span> <span class="o">=</span> <span class="n">geotiff_O3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">geotiff_O3avg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (year: 3, latitude: 400, longitude: 700)
Coordinates:
  * longitude  (longitude) float64 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float64 69.95 69.85 69.75 69.65 ... 30.25 30.15 30.05
  * year       (year) int64 2019 2020 2021
Data variables:
    O3         (year, latitude, longitude) float32 dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;
Attributes:
    transform:      [  0.1          0.         -25.00001201   0.          -0....
    crs:            +init=epsg:4326
    res:            [0.1 0.1]
    is_tiled:       0
    nodatavals:     0.0
    scales:         1.0
    offsets:        0.0
    AREA_OR_POINT:  Area
    regrid_method:  conservative</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d0936b08-ddbd-416d-ab3f-f47a6c2a32c2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d0936b08-ddbd-416d-ab3f-f47a6c2a32c2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 3</li><li><span class='xr-has-index'>latitude</span>: 400</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-cf4f1113-444b-4801-9974-1df0ea9d2fc5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cf4f1113-444b-4801-9974-1df0ea9d2fc5' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-9b9b6b5b-5ef6-4d2c-a89b-4bb27246e36f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b9b6b5b-5ef6-4d2c-a89b-4bb27246e36f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d770b45f-de60-4348-bf7a-fc19a2375008' class='xr-var-data-in' type='checkbox'><label for='data-d770b45f-de60-4348-bf7a-fc19a2375008' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.850012, -24.750012, ...,  44.749988,  44.849988,
        44.949988])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>69.95 69.85 69.75 ... 30.15 30.05</div><input id='attrs-a6b0be4c-2de8-4d7c-aa61-32e9e9587063' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a6b0be4c-2de8-4d7c-aa61-32e9e9587063' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ac81cf6-d7a2-4634-b423-f5b809cf9362' class='xr-var-data-in' type='checkbox'><label for='data-2ac81cf6-d7a2-4634-b423-f5b809cf9362' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([69.949997, 69.849997, 69.749997, ..., 30.249997, 30.149997, 30.049997])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2019 2020 2021</div><input id='attrs-36c89eae-0928-4366-9220-593f233ad709' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-36c89eae-0928-4366-9220-593f233ad709' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae6009a8-062c-4042-8049-72338d4d3074' class='xr-var-data-in' type='checkbox'><label for='data-ae6009a8-062c-4042-8049-72338d4d3074' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8f4532ff-c3f5-45fe-9424-e296a129210c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8f4532ff-c3f5-45fe-9424-e296a129210c' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>O3</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 400, 700), meta=np.ndarray&gt;</div><input id='attrs-fb2ef070-7459-4be8-bca4-7229934a6354' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb2ef070-7459-4be8-bca4-7229934a6354' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12d69e18-056e-402f-86c5-b14238eae5b0' class='xr-var-data-in' type='checkbox'><label for='data-12d69e18-056e-402f-86c5-b14238eae5b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>µg m-3</dd><dt><span>long_name :</span></dt><dd>CAMS OZONE</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.20 MiB </td> <td> 1.07 MiB </td></tr>
    <tr><th> Shape </th><td> (3, 400, 700) </td> <td> (1, 400, 700) </td></tr>
    <tr><th> Count </th><td> 17 Tasks </td><td> 3 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="194" height="133" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="68" x2="24" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="68" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="73" />
  <line x1="19" y1="9" x2="19" y2="78" />
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,83.52002652118297 10.0,68.57142857142857" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="83" x2="144" y2="83" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="83" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="83" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,83.52002652118297 24.9485979497544,83.52002652118297" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="103.520027" font-size="1.0rem" font-weight="100" text-anchor="middle" >700</text>
  <text x="164.948598" y="49.234312" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,49.234312)">400</text>
  <text x="7.474299" y="96.045728" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,96.045728)">3</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-840c7191-54af-42b4-9e17-6e6bede889ef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-840c7191-54af-42b4-9e17-6e6bede889ef' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>transform :</span></dt><dd>[  0.1          0.         -25.00001201   0.          -0.1
  69.999997  ]</dd><dt><span>crs :</span></dt><dd>+init=epsg:4326</dd><dt><span>res :</span></dt><dd>[0.1 0.1]</dd><dt><span>is_tiled :</span></dt><dd>0</dd><dt><span>nodatavals :</span></dt><dd>0.0</dd><dt><span>scales :</span></dt><dd>1.0</dd><dt><span>offsets :</span></dt><dd>0.0</dd><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>regrid_method :</span></dt><dd>conservative</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
</div>
<div class="section" id="visualize-average-and-maximum-values-over-march-june-for-2019-2020-and-2021">
<h3>Visualize average and Maximum values over March-June for 2019, 2020 and 2021<a class="headerlink" href="#visualize-average-and-maximum-values-over-march-june-for-2019-2020-and-2021" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>We aim at highlighting maritime and terrestrial transport activities before, during and after the first lockdown period in 2020</p></li>
</ul>
<div class="section" id="maximum-no2">
<h4>Maximum NO2<a class="headerlink" href="#maximum-no2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Maximum Surface NO2 over March-June &#39;</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="n">cmc</span><span class="o">.</span><span class="n">batlowW_r</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;NO2&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">80</span>                
<span class="n">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_NO2max</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_113_0.png" src="../../_images/air_quality_lockdown_113_0.png" />
</div>
</div>
</div>
<div class="section" id="average-no2">
<h4>Average NO2<a class="headerlink" href="#average-no2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Mean Surface NO2 over March-June &#39;</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="n">cmc</span><span class="o">.</span><span class="n">batlowW_r</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;NO2&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">10</span>                
<span class="n">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_NO2avg</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_115_0.png" src="../../_images/air_quality_lockdown_115_0.png" />
</div>
</div>
</div>
<div class="section" id="maximum-pm2-5">
<h4>Maximum PM2.5<a class="headerlink" href="#maximum-pm2-5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Maximum Surface Particule matter &lt; 2.5 µg m-3 over March-June &#39;</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="n">cmc</span><span class="o">.</span><span class="n">roma_r</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;PM2_5&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">50</span>                
<span class="n">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_PM2_5max</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_117_0.png" src="../../_images/air_quality_lockdown_117_0.png" />
</div>
</div>
</div>
<div class="section" id="average-pm2-5">
<h4>Average PM2.5<a class="headerlink" href="#average-pm2-5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Mean Surface Particule matter &lt; 2.5 µg m-3 over March-June &#39;</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="n">cmc</span><span class="o">.</span><span class="n">roma_r</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;PM2_5&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">15</span>                
<span class="n">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_PM2_5avg</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_119_0.png" src="../../_images/air_quality_lockdown_119_0.png" />
</div>
</div>
</div>
<div class="section" id="maximum-o3">
<h4>Maximum O3<a class="headerlink" href="#maximum-o3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Maximum Surface Ozone over March-June &#39;</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="s1">&#39;PiYG&#39;</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;O3&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">150</span>                
<span class="n">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_O3max</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_121_0.png" src="../../_images/air_quality_lockdown_121_0.png" />
</div>
</div>
</div>
<div class="section" id="average-o3">
<h4>Average O3<a class="headerlink" href="#average-o3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Mean Surface Ozone over March-June &#39;</span>
<span class="n">lcmap</span> <span class="o">=</span> <span class="s1">&#39;PiYG&#39;</span>
<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;O3&#39;</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">55</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">100</span>                
<span class="n">plot_multi_years</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">geotiff_O3avg</span><span class="p">,</span> <span class="n">lcmap</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/air_quality_lockdown_123_0.png" src="../../_images/air_quality_lockdown_123_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="time-series-of-no2-pm2-5-and-o3-at-specific-locations">
<h3>Time series of NO2, PM2.5 and O3 at specific locations<a class="headerlink" href="#time-series-of-no2-pm2-5-and-o3-at-specific-locations" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Oslo</span>         <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Oslo&#39;</span><span class="p">,</span>         <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">59.9139</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">10.7522</span><span class="p">}</span> 
<span class="n">Stockholm</span>    <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stockholm&#39;</span><span class="p">,</span>    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">59.3293</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">18.0686</span><span class="p">}</span> 
<span class="n">Paris</span>        <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Paris&#39;</span><span class="p">,</span>        <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">48.8566</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">2.3522</span><span class="p">}</span> 
<span class="n">Madrid</span>       <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span>       <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">40.4168</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">3.7038</span><span class="p">}</span> 
<span class="n">London</span>       <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;London&#39;</span><span class="p">,</span>       <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">51.5072</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">0.1276</span><span class="p">}</span> 
<span class="n">Milan</span>        <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Milan&#39;</span><span class="p">,</span>        <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">45.4642</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">9.1900</span><span class="p">}</span> 
<span class="n">Moscow</span>       <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Moscow&#39;</span><span class="p">,</span>       <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">55.7558</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">37.617</span><span class="p">}</span> 
<span class="n">Copenhagen</span>   <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Copenhagen&#39;</span><span class="p">,</span>   <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">55.6761</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">12.5683</span><span class="p">}</span> 
<span class="n">Warsaw</span>       <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Warsaw&#39;</span><span class="p">,</span>       <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">52.2297</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">21.0122</span><span class="p">}</span> 
<span class="n">Frankfurt</span>    <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Frankfurt&#39;</span><span class="p">,</span>    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">50.1109</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">8.6821</span><span class="p">}</span> 
<span class="n">Berlin</span>       <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Berlin&#39;</span><span class="p">,</span>       <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">52.5200</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">13.4050</span><span class="p">}</span> 
<span class="n">NorwegianSea</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;NorwegianSea&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span><span class="mf">61.0323</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span><span class="mf">1.694</span><span class="p">}</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">locations</span> <span class="o">=</span> <span class="p">[</span><span class="n">Oslo</span><span class="p">,</span> <span class="n">Stockholm</span><span class="p">,</span> <span class="n">Paris</span><span class="p">,</span> <span class="n">Madrid</span><span class="p">,</span> <span class="n">London</span><span class="p">,</span> <span class="n">Milan</span><span class="p">,</span> <span class="n">Moscow</span><span class="p">,</span> <span class="n">Copenhagen</span><span class="p">,</span> <span class="n">Warsaw</span><span class="p">,</span> <span class="n">Frankfurt</span><span class="p">,</span> <span class="n">Berlin</span><span class="p">,</span> <span class="n">NorwegianSea</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="visualize-selected-locations-on-a-map">
<h4>Visualize selected locations on a map<a class="headerlink" href="#visualize-selected-locations-on-a-map" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_locations</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">vmins</span><span class="p">,</span> <span class="n">vmaxs</span><span class="p">,</span> <span class="n">geotiffs</span><span class="p">,</span> <span class="n">lcmaps</span><span class="p">,</span> <span class="n">cities</span><span class="p">,</span> <span class="n">prefix_path</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Create 3 subplots</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="c1"># here 1 row, 3 columns and i plot</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj_plot</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">dset</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">lcmap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">geotiffs</span><span class="p">,</span> <span class="n">vmins</span><span class="p">,</span> <span class="n">vmaxs</span><span class="p">,</span> <span class="n">lcmaps</span><span class="p">):</span>
        <span class="nb">map</span> <span class="o">=</span> <span class="n">dset</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                                              <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">lcmap</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>

    <span class="c1"># Title for all plots</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Copernicus air quality forecasts on &#39;</span> <span class="o">+</span> <span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">plot_file</span> <span class="o">=</span> <span class="n">prefix_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">varnames</span><span class="p">)</span> <span class="o">+</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">plot_file</span><span class="p">,</span> <span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>  
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;3 years March-June average (2019, 2020 and 2021)&#39;</span>
<span class="n">varnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NO2&quot;</span><span class="p">,</span> <span class="s2">&quot;PM2_5&quot;</span><span class="p">,</span> <span class="s2">&quot;O3&quot;</span><span class="p">]</span>
<span class="n">vmins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">]</span>
<span class="n">vmaxs</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">100</span> <span class="p">]</span>
<span class="n">geotiffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">geotiff_NO2avg</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span> <span class="n">geotiff_PM2_5avg</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">),</span> <span class="n">geotiff_O3avg</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)]</span>
<span class="n">lcmaps</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmc</span><span class="o">.</span><span class="n">batlowW_r</span><span class="p">,</span> <span class="n">cmc</span><span class="o">.</span><span class="n">roma_r</span><span class="p">,</span>  <span class="s1">&#39;PiYG&#39;</span><span class="p">]</span>

<span class="n">proj_plot</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">plot_locations</span><span class="p">(</span><span class="n">proj_plot</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">vmins</span><span class="p">,</span> <span class="n">vmaxs</span><span class="p">,</span> <span class="n">geotiffs</span><span class="p">,</span> <span class="n">lcmaps</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 6.67 s, sys: 1.48 s, total: 8.15 s
Wall time: 42.7 s
</pre></div>
</div>
<img alt="../../_images/air_quality_lockdown_129_1.png" src="../../_images/air_quality_lockdown_129_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="plot-daily-averages-for-all-the-selected-locations">
<h3>Plot daily averages for all the selected locations<a class="headerlink" href="#plot-daily-averages-for-all-the-selected-locations" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">myFmt</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %B&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_timeseries</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)])</span>   
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
        <span class="n">hd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;#66c2a5&#39;</span><span class="p">,</span> <span class="s1">&#39;#fc8d62&#39;</span><span class="p">,</span> <span class="s1">&#39;#8da0cb&#39;</span><span class="p">]):</span>
            <span class="n">dfyear</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)[</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="n">variable</span><span class="p">]</span>
<span class="c1">#            dfyear.to_netcdf(variable + &#39;_timeseries_&#39; + l[&#39;name&#39;] + &#39;_&#39; + str(year) + &#39;.nc&#39;)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">dfyear</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            <span class="n">dfyear</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">hd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)))</span>
            
            <span class="n">dt</span> <span class="o">=</span> <span class="n">dfyear</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
            <span class="n">dt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
            <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">ax</span><span class="p">],</span> <span class="n">handles</span><span class="o">=</span><span class="n">hd</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Copernicus air quality forecasts &#39;</span> <span class="o">+</span> <span class="n">variable</span> <span class="o">+</span> <span class="s1">&#39; from March to June in &#39;</span> <span class="o">+</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">myFmt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="n">plot_file</span> <span class="o">=</span> <span class="n">prefix_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">variable</span> <span class="o">+</span> <span class="s1">&#39;_rolling_7d&#39;</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">plot_file</span><span class="p">,</span> <span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>  
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_file</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">prefix_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">variable</span> <span class="o">+</span> <span class="s1">&#39;_timeseries_&#39;</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="n">geotiff_NO2</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">prefix_path</span><span class="o">=</span><span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pm2-5">
<h4>PM2.5<a class="headerlink" href="#pm2-5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="n">geotiff_PM2_5</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">prefix_path</span><span class="o">=</span><span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="o3">
<h4>O3<a class="headerlink" href="#o3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="n">geotiff_O3</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">prefix_path</span><span class="o">=</span><span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="years-2019-2020-and-2021-march-june-average-at-each-selected-location">
<h3>3 years (2019, 2020 and 2021) March-June average at each selected location<a class="headerlink" href="#years-2019-2020-and-2021-march-june-average-at-each-selected-location" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_location_stats</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">prefix_path</span><span class="p">):</span> 
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">dfyear</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">dfyear</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">dt</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">year</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">dt</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">result</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Total &#39;</span> <span class="o">+</span> <span class="n">variable</span> <span class="o">+</span> <span class="s1">&#39; averaged (March-June) at selected location&#39;</span><span class="p">)</span>
    <span class="n">plot_file</span> <span class="o">=</span> <span class="n">prefix_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;Total &#39;</span> <span class="o">+</span> <span class="n">variable</span> <span class="o">+</span> <span class="s1">&#39;at_12_differents_locations&#39;</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_file</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">plot_file</span><span class="p">,</span> <span class="n">plot_file</span> <span class="o">+</span> <span class="s1">&#39;.bak&#39;</span><span class="p">)</span>  
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="no2">
<h3>NO2<a class="headerlink" href="#no2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats_loc</span> <span class="o">=</span> <span class="n">plot_location_stats</span><span class="p">(</span><span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="n">geotiff_NO2</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>PM2.5<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats_loc</span> <span class="o">=</span> <span class="n">plot_location_stats</span><span class="p">(</span><span class="s1">&#39;PM2_5&#39;</span><span class="p">,</span> <span class="n">geotiff_PM2_5</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>O3<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats_loc</span> <span class="o">=</span> <span class="n">plot_location_stats</span><span class="p">(</span><span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="n">geotiff_O3</span><span class="p">,</span> <span class="n">locations</span><span class="p">,</span> <span class="n">OUTPUT_DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="a-id-9-discussion-a-discussion">
<h2><a id=9.Discussion></a> Discussion<a class="headerlink" href="#a-id-9-discussion-a-discussion" title="Permalink to this headline">¶</a></h2>
<p>Maritime routes in the mediteranean areas significantly descreased during the 2020 lockdown, especially from the Suez Canal and along North African coasts. However, these activities are now larger than before covid.</p>
</div>
<div class="section" id="a-id-10-conclusion-a-conclusion">
<h2><a id=10.Conclusion></a> Conclusion<a class="headerlink" href="#a-id-10-conclusion-a-conclusion" title="Permalink to this headline">¶</a></h2>
<p>We observed changes for NO2 and for some town PM2.5 but there is no evidence of any sgnificant changes on surface Ozone during the lockdown. A more thorough analysis is required, in particular taking into account meteorological conditions that greatly affect the production of such chemical species.</p>
</div>
<div class="section" id="a-id-11-research-object-a-creation-of-research-object-in-rohub">
<h2><a id=11.Research_Object></a> Creation of research Object in Rohub<a class="headerlink" href="#a-id-11-research-object-a-creation-of-research-object-in-rohub" title="Permalink to this headline">¶</a></h2>
<div class="alert alert-warning alert-info">
    The following lines of code will show you how to authenticate to <b>ROHub</b> using your username and password.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rohub</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="authenticate">
<h3>Authenticate<a class="headerlink" href="#authenticate" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>you need to create two files in your HOME</p>
<ul>
<li><p>rohub-user: contains your rohub username</p></li>
<li><p>rohub-pwd: add your password in this file</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rohub_user</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span><span class="s2">&quot;rohub-user&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="n">rohub_pwd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span><span class="s2">&quot;rohub-pwd&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="n">rohub</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">rohub_user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">rohub_pwd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logged successfully as annefou@geo.uio.no.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creation-of-a-new-executable-research-object">
<h3>Creation of a new executable Research Object<a class="headerlink" href="#creation-of-a-new-executable-research-object" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ro_title</span><span class="o">=</span><span class="s2">&quot;Impact of the Covid-19 Lockdown on Air quality over Europe using Copernicus Atmosphere Monitoring Service&quot;</span>
<span class="n">ro_research_areas</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Earth sciences&quot;</span><span class="p">]</span>
<span class="n">ro_description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;This notebook shows how to discover and access the [Copernicus Atmosphere Monitoring](https://ads.atmosphere.copernicus.eu/#!/home) products available </span>
<span class="s2">in the **RELIANCE** datacube resources, by using the functionalities provided in the &lt;font color=&#39;blue&#39;&gt; **Adam API** &lt;/font&gt;. </span>

<span class="s2">The COVID-19 pandemic has led to significant reductions in economic activity, especially during lockdowns. Several studies has shown that the concentration of nitrogen </span>
<span class="s2">dioxyde and particulate matter levels have reduced during lockdown events. Reductions in transportation sector emissions are most likely largely responsible for the NO2 </span>
<span class="s2">anomalies. In this study, we analyze the impact of lockdown events on the air quality using data from [Copernicus Atmosphere Monitoring Service](https://ads.atmosphere.copernicus.eu/).</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">ro_ros_type</span><span class="o">=</span><span class="s2">&quot;Executable Research Object&quot;</span>
<span class="n">ro_ros_template</span><span class="o">=</span><span class="s2">&quot;Executable Research Object folders structure&quot;</span>

<span class="n">ro</span> <span class="o">=</span> <span class="n">rohub</span><span class="o">.</span><span class="n">ros_create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">ro_title</span><span class="p">,</span> <span class="n">research_areas</span><span class="o">=</span><span class="n">ro_research_areas</span><span class="p">,</span> 
                      <span class="n">description</span><span class="o">=</span><span class="n">ro_description</span><span class="p">,</span> 
                      <span class="n">use_template</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">ros_type</span><span class="o">=</span><span class="n">ro_ros_type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./science/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Urban-heat-island-ERA5-Land.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Urban Heat Island effect in Fortaleza, Brazil</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="comparisons_with_air_quality_measurements.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Jupyter notebook comparing CAMS and air quality measurements</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Anne Fouilloux<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>